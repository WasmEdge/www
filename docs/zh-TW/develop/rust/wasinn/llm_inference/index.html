<!doctype html>
<html lang="zh-TW" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-develop/rust/wasinn/llm_inference">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Llama 2 inference | WasmEdge Developer Guides</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:image" content="https://wasmedge.org/docs/zh-TW/./static/img/wasm_logo.png"><meta data-rh="true" property="og:url" content="https://wasmedge.org/docs/zh-TW/develop/rust/wasinn/llm_inference"><meta data-rh="true" name="docusaurus_locale" content="zh-TW"><meta data-rh="true" name="docsearch:language" content="zh-TW"><meta data-rh="true" name="keywords" content="wasmedge, wasm, web assembly, rust, cncf, edge devices, cloud, serverless"><meta data-rh="true" name="og:title" content="WasmEdge"><meta data-rh="true" name="og:description" content="WasmEdge is a lightweight, high-performance, and extensible WebAssembly runtime for cloud native, edge, and decentralized applications. It powers serverless apps, embedded functions, microservices, smart contracts, and IoT devices."><meta data-rh="true" name="og:url" content="https://wasmedge.org/"><meta data-rh="true" name="og:type" content="Documentation"><meta data-rh="true" name="twitter:card" content="summary"><meta data-rh="true" name="twitter:image" content="summary_large_image"><meta data-rh="true" name="twitter:url" content="https://wasmedge.org/"><meta data-rh="true" name="twitter:site" content="@realwasmedge"><meta data-rh="true" name="twitter:title" content="WasmEdge"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Llama 2 inference | WasmEdge Developer Guides"><meta data-rh="true" name="description" content="WasmEdge now supports running llama2 series of models in Rust. We will use this example project to show how to make AI inferences with the llama2 model in WasmEdge and Rust."><meta data-rh="true" property="og:description" content="WasmEdge now supports running llama2 series of models in Rust. We will use this example project to show how to make AI inferences with the llama2 model in WasmEdge and Rust."><link data-rh="true" rel="icon" href="/docs/zh-TW/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://wasmedge.org/docs/zh-TW/develop/rust/wasinn/llm_inference"><link data-rh="true" rel="alternate" href="https://wasmedge.org/docs/develop/rust/wasinn/llm_inference" hreflang="en"><link data-rh="true" rel="alternate" href="https://wasmedge.org/docs/zh/develop/rust/wasinn/llm_inference" hreflang="zh"><link data-rh="true" rel="alternate" href="https://wasmedge.org/docs/zh-TW/develop/rust/wasinn/llm_inference" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://wasmedge.org/docs/develop/rust/wasinn/llm_inference" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Q77VSJHYQB"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-Q77VSJHYQB",{})</script><link rel="stylesheet" href="/docs/zh-TW/assets/css/styles.c838d24b.css">
<link rel="preload" href="/docs/zh-TW/assets/js/runtime~main.8e325d4b.js" as="script">
<link rel="preload" href="/docs/zh-TW/assets/js/main.98852c41.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="跳至主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳至主要内容</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like WasmEdge, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/WasmEdge/WasmEdge">GitHub</a>! ⭐️</div><button type="button" aria-label="關閉" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="主導航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/zh-TW/"><div class="navbar__logo"><img src="/docs/zh-TW/img/logo.svg" alt="WasmEdge Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/zh-TW/img/logo.svg" alt="WasmEdge Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">WasmEdge</b></a><a class="navbar__item navbar__link" href="/docs/zh-TW/start/overview">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/zh-TW/develop/overview">Develop</a><a class="navbar__item navbar__link" href="/docs/zh-TW/embed/overview">Embed</a><a class="navbar__item navbar__link" href="/docs/zh-TW/contribute/overview">Extend</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link icon-link language navbar__item"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中文（台灣）</a><ul class="dropdown__menu"><li><a href="/docs/develop/rust/wasinn/llm_inference" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/docs/zh/develop/rust/wasinn/llm_inference" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">简体中文</a></li><li><a href="/docs/zh-TW/develop/rust/wasinn/llm_inference" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-TW">中文（台灣）</a></li></ul></div><a href="https://github.com/WasmEdge/WasmEdge" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" alt="https://github.com/WasmEdge/WasmEdge"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切換淺色/暗黑模式（當前為淺色模式）" aria-label="切換淺色/暗黑模式（當前為淺色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到頂部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文件側邊欄" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/zh-TW/develop/overview">Develop WASM Apps</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/zh-TW/category/develop-wasm-apps-in-rust">Develop WASM Apps in Rust</a><button aria-label="打開/收起側邊欄選單「Develop WASM Apps in Rust」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-TW/develop/rust/setup">Set up Rust toolchain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-TW/develop/rust/hello_world">Hello world</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-TW/develop/rust/os">Access OS services</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/zh-TW/category/http-services">HTTP services</a><button aria-label="打開/收起側邊欄選單「HTTP services」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/zh-TW/category/socket-networking">Socket networking</a><button aria-label="打開/收起側邊欄選單「Socket networking」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/zh-TW/category/ai-inference">AI inference</a><button aria-label="打開/收起側邊欄選單「AI inference」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/zh-TW/develop/rust/wasinn/llm_inference">Llama 2 inference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-TW/develop/rust/wasinn/mediapipe">Mediapipe solutions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-TW/develop/rust/wasinn/pytorch">PyTorch Backend</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-TW/develop/rust/wasinn/tensorflow_lite">TensorFlow Lite Backend</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-TW/develop/rust/wasinn/openvino">OpenVINO Backend</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-TW/develop/rust/wasinn/tf_plugin">TensorFlow Plug-in For WasmEdge</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/zh-TW/category/database-drivers">Database drivers</a><button aria-label="打開/收起側邊欄選單「Database drivers」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-TW/develop/rust/dapr">Dapr services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-TW/develop/rust/wasicrypto">Crypto for WASI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-TW/develop/rust/bindgen">Bindgen of Rust Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-TW/develop/rust/command">Command interface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-TW/develop/rust/ssr">Server-side rendering</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/zh-TW/category/develop-wasm-apps-in-javascript">Develop WASM Apps in JavaScript</a><button aria-label="打開/收起側邊欄選單「Develop WASM Apps in JavaScript」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/zh-TW/category/develop-wasm-apps-in-cc">Develop WASM Apps in C/C++</a><button aria-label="打開/收起側邊欄選單「Develop WASM Apps in C/C++」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/zh-TW/category/develop-wasm-apps-in-python">Develop WASM Apps in Python</a><button aria-label="打開/收起側邊欄選單「Develop WASM Apps in Python」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/zh-TW/category/develop-wasm-apps-in-go">Develop WASM Apps in Go</a><button aria-label="打開/收起側邊欄選單「Develop WASM Apps in Go」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/zh-TW/category/deploy-wasmedge-apps-in-kubernetes">Deploy WasmEdge apps in Kubernetes</a><button aria-label="打開/收起側邊欄選單「Deploy WasmEdge apps in Kubernetes」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起側邊欄" aria-label="收起側邊欄" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="頁面路徑"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主頁面" class="breadcrumbs__link" href="/docs/zh-TW/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/zh-TW/category/develop-wasm-apps-in-rust"><span itemprop="name">Develop WASM Apps in Rust</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/zh-TW/category/ai-inference"><span itemprop="name">AI inference</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Llama 2 inference</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本頁導覽</button></div><div class="theme-doc-markdown markdown"><h1>Llama 2 inference</h1><p>WasmEdge now supports running llama2 series of models in Rust. We will use <a href="https://github.com/second-state/LlamaEdge/tree/main/chat" target="_blank" rel="noopener noreferrer">this example project</a> to show how to make AI inferences with the llama2 model in WasmEdge and Rust.</p><p>WasmEdge now supports the following models:</p><ol><li>Llama-2-7B-Chat</li><li>Llama-2-13B-Chat</li><li>CodeLlama-13B-Instruct</li><li>Mistral-7B-Instruct-v0.1</li><li>Mistral-7B-Instruct-v0.2</li><li>MistralLite-7B</li><li>OpenChat-3.5-0106</li><li>OpenChat-3.5-1210</li><li>OpenChat-3.5</li><li>Wizard-Vicuna-13B-Uncensored-GGUF</li><li>TinyLlama-1.1B-Chat-v1.0</li><li>Baichuan2-13B-Chat</li><li>OpenHermes-2.5-Mistral-7B</li><li>Dolphin-2.2-Yi-34B</li><li>Dolphin-2.6-Mistral-7B</li><li>Samantha-1.2-Mistral-7B</li><li>Samantha-1.11-CodeLlama-34B</li><li>WizardCoder-Python-7B-V1.0</li><li>Zephyr-7B-Alpha</li><li>WizardLM-13B-V1.0-Uncensored</li><li>Orca-2-13B</li><li>Neural-Chat-7B-v3-1</li><li>Yi-34B-Chat</li><li>Starling-LM-7B-alpha</li><li>DeepSeek-Coder-6.7B</li><li>DeepSeek-LLM-7B-Chat</li><li>SOLAR-10.7B-Instruct-v1.0</li><li>Mixtral-8x7B-Instruct-v0.1</li><li>Nous-Hermes-2-Mixtral-8x7B-DPO</li><li>Nous-Hermes-2-Mixtral-8x7B-SFT</li></ol><p>And more, please check <a href="https://github.com/second-state/LlamaEdge/blob/main/models.md" target="_blank" rel="noopener noreferrer">the supported models</a> for detials.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisite">Prerequisite<a href="#prerequisite" class="hash-link" aria-label="Prerequisite的直接連結" title="Prerequisite的直接連結">​</a></h2><p>Besides the <a href="/docs/zh-TW/develop/rust/setup">regular WasmEdge and Rust requirements</a>, please make sure that you have the <a href="/docs/zh-TW/start/install#wasi-nn-plug-in-with-ggml-backend">Wasi-NN plugin with ggml installed</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="quick-start">Quick start<a href="#quick-start" class="hash-link" aria-label="Quick start的直接連結" title="Quick start的直接連結">​</a></h2><p>Because the example already includes a compiled WASM file from the Rust code, we could use WasmEdge CLI to execute the example directly.</p><p>First, get the latest llama-chat wasm application</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">-LO</span><span class="token plain"> https://github.com/LlamaEdge/LlamaEdge/releases/latest/download/llama-chat.wasm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, let&#x27;s get the model. In this example, we are going to use the llama2 7b chat model in GGUF format. You can also use other kinds of llama2 models, check out <a href="https://github.com/second-state/llamaedge/blob/main/chat/README.md#get-model" target="_blank" rel="noopener noreferrer">here</a>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">-LO</span><span class="token plain"> https://huggingface.co/wasmedge/llama2/resolve/main/llama-2-7b-chat-q5_k_m.gguf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Run the inference application in WasmEdge.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">wasmedge </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">--dir</span><span class="token plain"> .:. --nn-preload default:GGML:AUTO:llama-2-7b-chat-q5_k_m.gguf llama-chat.wasm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After executing the command, you may need to wait a moment for the input prompt to appear. You can enter your question once you see the <code>[USER]:</code> prompt:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token environment constant" style="color:rgb(72, 118, 214)">USER</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">I have two apples, each costing </span><span class="token number" style="color:rgb(170, 9, 130)">5</span><span class="token plain"> dollars. What is the total cost of these apple</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">ASSISTANT</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">The total cost of the two apples is </span><span class="token number" style="color:rgb(170, 9, 130)">10</span><span class="token plain"> dollars.</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token environment constant" style="color:rgb(72, 118, 214)">USER</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">How about four apples?</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">ASSISTANT</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">The total cost of four apples is </span><span class="token number" style="color:rgb(170, 9, 130)">20</span><span class="token plain"> dollars.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="build-and-run">Build and run<a href="#build-and-run" class="hash-link" aria-label="Build and run的直接連結" title="Build and run的直接連結">​</a></h2><p>Let&#x27;s build the wasm file from the rust source code. First, git clone the <code>llamaedge</code> repo.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">git</span><span class="token plain"> clone https://github.com/LlamaEdge/LlamaEdge.git</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">cd</span><span class="token plain"> chat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Second, use <code>cargo</code> to build the example project.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">cargo</span><span class="token plain"> build </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">--target</span><span class="token plain"> wasm32-wasi </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">--release</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The output WASM file is <code>target/wasm32-wasi/release/llama-chat.wasm</code>. Next, use WasmEdge to load the llama-2-7b model and then ask the model to questions.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">wasmedge </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">--dir</span><span class="token plain"> .:. --nn-preload default:GGML:AUTO:llama-2-7b-chat-q5_k_m.gguf llama-chat.wasm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After executing the command, you may need to wait a moment for the input prompt to appear. You can enter your question once you see the <code>[USER]:</code> prompt:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token environment constant" style="color:rgb(72, 118, 214)">USER</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">Who is Robert Oppenheimer?</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">ASSISTANT</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">Robert Oppenheimer was an American theoretical physicist and director of the Manhattan Project, </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">which</span><span class="token plain"> developed the atomic bomb during World War II. He is widely regarded as one of the </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">most</span><span class="token plain"> important physicists of the 20th century and is known </span><span class="token keyword" style="color:rgb(12, 150, 155)">for</span><span class="token plain"> his contributions to the development of quantum mechanics and the theory of the atomic nucleus. Oppenheimer was also a prominent figure </span><span class="token keyword" style="color:rgb(12, 150, 155)">in</span><span class="token plain"> the post-war nuclear weapons debate and was a strong advocate </span><span class="token keyword" style="color:rgb(12, 150, 155)">for</span><span class="token plain"> international cooperation on nuclear weapons control.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="options">Options<a href="#options" class="hash-link" aria-label="Options的直接連結" title="Options的直接連結">​</a></h2><p>You can configure the chat inference application through CLI options.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">  -m, --model-alias </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">ALIAS</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          Model </span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">alias</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">default: default</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  -c, --ctx-size </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">CTX_SIZE</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          Size of the prompt context </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">default: </span><span class="token number" style="color:rgb(170, 9, 130)">4096</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  -n, --n-predict </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">N_PRDICT</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          Number of tokens to predict </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">default: </span><span class="token number" style="color:rgb(170, 9, 130)">1024</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  -g, --n-gpu-layers </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">N_GPU_LAYERS</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          Number of layers to run on the GPU </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">default: </span><span class="token number" style="color:rgb(170, 9, 130)">100</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  -b, --batch-size </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">BATCH_SIZE</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          Batch size </span><span class="token keyword" style="color:rgb(12, 150, 155)">for</span><span class="token plain"> prompt processing </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">default: </span><span class="token number" style="color:rgb(170, 9, 130)">4096</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  -r, --reverse-prompt </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">REVERSE_PROMPT</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          Halt generation at PROMPT, </span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">return</span><span class="token plain"> control.</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  -s, --system-prompt </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">SYSTEM_PROMPT</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          System prompt message string </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">default: </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;[Default system message for the prompt template]&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  -p, --prompt-template </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">TEMPLATE</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          Prompt template. </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">default: llama-2-chat</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">possible values: llama-2-chat, codellama-instruct, mistral-instruct-v0.1, mistrallite, openchat, belle-llama-2-chat, vicuna-chat, chatml</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      --log-prompts</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          Print prompt strings to stdout</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      --log-stat</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          Print statistics to stdout</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      --log-all</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          Print all log information to stdout</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      --stream-stdout</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          Print the output to stdout </span><span class="token keyword" style="color:rgb(12, 150, 155)">in</span><span class="token plain"> the streaming way</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  -h, </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">--help</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          Print </span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">help</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>--prompt-template</code> option is perhaps the most interesting. It allows the application to support different open source LLM models beyond llama2. Check out more prompt templates <a href="https://github.com/LlamaEdge/LlamaEdge/tree/main/api-server/chat-prompts" target="_blank" rel="noopener noreferrer">here</a>.</p><table><thead><tr><th>Template name</th><th>Model</th><th>Download</th></tr></thead><tbody><tr><td>llama-2-chat</td><td><a href="https://ai.meta.com/llama/" target="_blank" rel="noopener noreferrer">The standard llama2 chat model</a></td><td><a href="https://huggingface.co/wasmedge/llama2/resolve/main/llama-2-7b-chat-q5_k_m.gguf" target="_blank" rel="noopener noreferrer">7b</a></td></tr><tr><td>codellama-instruct</td><td><a href="https://about.fb.com/news/2023/08/code-llama-ai-for-coding/" target="_blank" rel="noopener noreferrer">CodeLlama</a></td><td><a href="https://huggingface.co/TheBloke/CodeLlama-7B-Instruct-GGUF/resolve/main/codellama-7b-instruct.Q5_K_M.gguf" target="_blank" rel="noopener noreferrer">7b</a></td></tr><tr><td>mistral-instruct-v0.1</td><td><a href="https://mistral.ai/" target="_blank" rel="noopener noreferrer">Mistral</a></td><td><a href="https://huggingface.co/TheBloke/Mistral-7B-Instruct-v0.1-GGUF/resolve/main/mistral-7b-instruct-v0.1.Q5_K_M.gguf" target="_blank" rel="noopener noreferrer">7b</a></td></tr><tr><td>mistrallite</td><td><a href="https://huggingface.co/amazon/MistralLite" target="_blank" rel="noopener noreferrer">Mistral Lite</a></td><td><a href="https://huggingface.co/TheBloke/MistralLite-7B-GGUF/resolve/main/mistrallite.Q5_K_M.gguf" target="_blank" rel="noopener noreferrer">7b</a></td></tr><tr><td>openchat</td><td><a href="https://github.com/imoneoi/openchat" target="_blank" rel="noopener noreferrer">OpenChat</a></td><td><a href="https://huggingface.co/TheBloke/openchat_3.5-GGUF/resolve/main/openchat_3.5.Q5_K_M.gguf" target="_blank" rel="noopener noreferrer">7b</a></td></tr><tr><td>belle-llama-2-chat</td><td><a href="https://github.com/LianjiaTech/BELLE" target="_blank" rel="noopener noreferrer">BELLE</a></td><td><a href="https://huggingface.co/second-state/BELLE-Llama2-13B-Chat-0.4M-GGUF/resolve/main/BELLE-Llama2-13B-Chat-0.4M-ggml-model-q4_0.gguf" target="_blank" rel="noopener noreferrer">13b</a></td></tr><tr><td>vicuna-chat</td><td><a href="https://lmsys.org/blog/2023-03-30-vicuna/" target="_blank" rel="noopener noreferrer">Vicuna</a></td><td><a href="https://huggingface.co/TheBloke/vicuna-7B-v1.5-GGUF/resolve/main/vicuna-7b-v1.5.Q5_K_M.gguf" target="_blank" rel="noopener noreferrer">7b</a></td></tr><tr><td>chatml</td><td><a href="https://huggingface.co/chargoddard/rpguild-chatml-13b" target="_blank" rel="noopener noreferrer">ChatML</a></td><td><a href="https://huggingface.co/TheBloke/rpguild-chatml-13B-GGUF/resolve/main/rpguild-chatml-13b.Q5_K_M.gguf" target="_blank" rel="noopener noreferrer">13b</a></td></tr></tbody></table><p>Furthermore, the following command tells WasmEdge to print out logs and statistics of the model at runtime.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">wasmedge </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">--dir</span><span class="token plain"> .:. --nn-preload default:GGML:AUTO:llama-2-7b-chat-q5_k_m.gguf </span><span class="token punctuation" style="color:rgb(153, 76, 195)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  llama-chat.wasm --prompt-template llama-2-chat --log-stat</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">llama_new_context_with_model: n_ctx      </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">512</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">llama_new_context_with_model: freq_base  </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">10000.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">llama_new_context_with_model: freq_scale </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">llama_new_context_with_model: kv self size  </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">  </span><span class="token number" style="color:rgb(170, 9, 130)">256.00</span><span class="token plain"> MB</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">llama_new_context_with_model: compute buffer total size </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">76.63</span><span class="token plain"> MB</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token number" style="color:rgb(170, 9, 130)">2023</span><span class="token plain">-11-07 02:07:44.019</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">WASI-NN</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"> GGML backend: llama_system_info: AVX </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> AVX2 </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> AVX512 </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> AVX512_VBMI </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> AVX512_VNNI </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> FMA </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> NEON </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> ARM_FMA </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> F16C </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> FP16_VA </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> WASM_SIMD </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> BLAS </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> SSE3 </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> SSSE3 </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> VSX </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">llama_print_timings:        load </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">time</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">   </span><span class="token number" style="color:rgb(170, 9, 130)">11523.19</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">llama_print_timings:      sample </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">time</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">       </span><span class="token number" style="color:rgb(170, 9, 130)">2.62</span><span class="token plain"> ms /   </span><span class="token number" style="color:rgb(170, 9, 130)">102</span><span class="token plain"> runs   </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0.03</span><span class="token plain"> ms per token, </span><span class="token number" style="color:rgb(170, 9, 130)">38961.04</span><span class="token plain"> tokens per second</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">llama_print_timings: prompt </span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">eval</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">time</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">   </span><span class="token number" style="color:rgb(170, 9, 130)">11479.27</span><span class="token plain"> ms /    </span><span class="token number" style="color:rgb(170, 9, 130)">49</span><span class="token plain"> tokens </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">  </span><span class="token number" style="color:rgb(170, 9, 130)">234.27</span><span class="token plain"> ms per token,     </span><span class="token number" style="color:rgb(170, 9, 130)">4.27</span><span class="token plain"> tokens per second</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">llama_print_timings:        </span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">eval</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">time</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">   </span><span class="token number" style="color:rgb(170, 9, 130)">13571.37</span><span class="token plain"> ms /   </span><span class="token number" style="color:rgb(170, 9, 130)">101</span><span class="token plain"> runs   </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">  </span><span class="token number" style="color:rgb(170, 9, 130)">134.37</span><span class="token plain"> ms per token,     </span><span class="token number" style="color:rgb(170, 9, 130)">7.44</span><span class="token plain"> tokens per second</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">llama_print_timings:       total </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">time</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">   </span><span class="token number" style="color:rgb(170, 9, 130)">25104.57</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">ASSISTANT</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">Ah, a fellow Peanuts enthusiast</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain"> Snoopy is Charlie Brown</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;s lovable and imaginative beagle, known for his wild and wacky adventures in the comic strip and television specials. He&#x27;</span><span class="token plain">s a loyal companion to Charlie Brown and the rest of the Peanuts gang, and his antics often provide comic relief </span><span class="token keyword" style="color:rgb(12, 150, 155)">in</span><span class="token plain"> the series. Is there anything </span><span class="token keyword" style="color:rgb(12, 150, 155)">else</span><span class="token plain"> you&#x27;d like to know about Snoopy? 🐶</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improving-performance">Improving performance<a href="#improving-performance" class="hash-link" aria-label="Improving performance的直接連結" title="Improving performance的直接連結">​</a></h2><p>You can make the inference program run faster by AOT compiling the wasm file first.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">wasmedge compile llama-chat.wasm llama-chat.wasm</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">wasmedge </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">--dir</span><span class="token plain"> .:.  --nn-preload default:GGML:AUTO:llama-2-7b-chat-q5_k_m.gguf llama-chat.wasm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="understand-the-code">Understand the code<a href="#understand-the-code" class="hash-link" aria-label="Understand the code的直接連結" title="Understand the code的直接連結">​</a></h2><p>The <a href="https://github.com/second-state/llamaedge/blob/main/chat/src/main.rs" target="_blank" rel="noopener noreferrer">main.rs</a> is the full Rust code to create an interactive chatbot using a LLM. The Rust program manages the user input, tracks the conversation history, transforms the text into the llama2 and other model’s chat templates, and runs the inference operations using the WASI NN standard API. The code logic for the chat interaction is somewhat complex. In this section, we will use the <a href="https://github.com/second-state/llamaedge/tree/main/simple" target="_blank" rel="noopener noreferrer">simple example</a> to explain how to set up and perform one inference round trip. Here is how you use the simple example.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic"># Download the compiled simple inference wasm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">-LO</span><span class="token plain"> https://github.com/second-state/llamaedge/releases/latest/download/llama-simple.wasm</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic"># Give it a prompt and ask it to use the model to complete it.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">wasmedge </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">--dir</span><span class="token plain"> .:. --nn-preload default:GGML:AUTO:llama-2-7b-chat-q5_k_m.gguf llama-simple.wasm </span><span class="token punctuation" style="color:rgb(153, 76, 195)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">--prompt</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;Robert Oppenheimer most important achievement is &#x27;</span><span class="token plain"> --ctx-size </span><span class="token number" style="color:rgb(170, 9, 130)">4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">output: </span><span class="token keyword" style="color:rgb(12, 150, 155)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">1942</span><span class="token plain">, when he led the team that developed the first atomic bomb, </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">which</span><span class="token plain"> was dropped on Hiroshima, Japan </span><span class="token keyword" style="color:rgb(12, 150, 155)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">1945</span><span class="token plain">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>First, let&#x27;s parse command line arguments to customize the chatbot&#x27;s behavior using <code>Command</code> struct. It extracts the following parameters: <code>prompt</code> (a prompt that guides the conversation), <code>model_alias</code> (a list for the loaded model), and <code>ctx_size</code> (the size of the chat context).</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(153, 76, 195);font-style:italic">main</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Result</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">String</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> matches </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Command</span><span class="token punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">new</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Simple LLM inference&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">arg</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token class-name" style="color:rgb(17, 17, 17)">Arg</span><span class="token punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">new</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;prompt&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">short</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token char" style="color:rgb(72, 118, 214)">&#x27;p&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">long</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;prompt&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">value_name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;PROMPT&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">help</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Sets the prompt.&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">required</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">arg</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token class-name" style="color:rgb(17, 17, 17)">Arg</span><span class="token punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">new</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;model_alias&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">short</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token char" style="color:rgb(72, 118, 214)">&#x27;m&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">long</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;model-alias&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">value_name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;ALIAS&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">help</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Sets the model alias&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">default_value</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;default&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">arg</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token class-name" style="color:rgb(17, 17, 17)">Arg</span><span class="token punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">new</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;ctx_size&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">short</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token char" style="color:rgb(72, 118, 214)">&#x27;c&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">long</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;ctx-size&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">value_parser</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token namespace" style="color:rgb(12, 150, 155)">clap</span><span class="token namespace punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token macro property" style="color:rgb(12, 150, 155)">value_parser!</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token keyword" style="color:rgb(12, 150, 155)">u32</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">value_name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;CTX_SIZE&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">help</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Sets the prompt context size&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">default_value</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token constant" style="color:rgb(72, 118, 214)">DEFAULT_CTX_SIZE</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">get_matches</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// model alias</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> model_name </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> matches</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">get_one</span><span class="token punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token class-name" style="color:rgb(17, 17, 17)">String</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;model_alias&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">unwrap</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">to_string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// prompt context size</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> ctx_size </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> matches</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">get_one</span><span class="token punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token keyword" style="color:rgb(12, 150, 155)">u32</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;ctx_size&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">unwrap</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token constant" style="color:rgb(72, 118, 214)">CTX_SIZE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">set</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain">ctx_size </span><span class="token keyword" style="color:rgb(12, 150, 155)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">usize</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">expect</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Fail to parse prompt context size&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// prompt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> prompt </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> matches</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">get_one</span><span class="token punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token class-name" style="color:rgb(17, 17, 17)">String</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;prompt&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">unwrap</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">to_string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After that, the program will create a new Graph using the <code>GraphBuilder</code> and loads the model specified by the <code>model_name</code> .</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// load the model to wasi-nn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">     </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> graph </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token namespace" style="color:rgb(12, 150, 155)">wasi_nn</span><span class="token namespace punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token class-name" style="color:rgb(17, 17, 17)">GraphBuilder</span><span class="token punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">new</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token namespace" style="color:rgb(12, 150, 155)">wasi_nn</span><span class="token namespace punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token class-name" style="color:rgb(17, 17, 17)">GraphEncoding</span><span class="token punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token class-name" style="color:rgb(17, 17, 17)">Ggml</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(12, 150, 155)">wasi_nn</span><span class="token namespace punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token class-name" style="color:rgb(17, 17, 17)">ExecutionTarget</span><span class="token punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token constant" style="color:rgb(72, 118, 214)">AUTO</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">build_from_cache</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;</span><span class="token plain">model_name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">expect</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Failed to load the model&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, We create an execution context from the loaded Graph. The context is mutable because we will be changing it when we set the input tensor and execute the inference.</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// initialize the execution context</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">mut</span><span class="token plain"> context </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> graph</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">init_execution_context</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">expect</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Failed to init context&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, The prompt is converted into bytes and set as the input tensor for the model inference.</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// set input tensor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> tensor_data </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">as_str</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">as_bytes</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">to_vec</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    context</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">set_input</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(12, 150, 155)">wasi_nn</span><span class="token namespace punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token class-name" style="color:rgb(17, 17, 17)">TensorType</span><span class="token punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token constant" style="color:rgb(72, 118, 214)">U8</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;</span><span class="token plain">tensor_data</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">expect</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Failed to set prompt as the input tensor&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, execute the model inference.</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// execute the inference</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    context</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">compute</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">expect</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Failed to complete inference&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After the inference is finished, extract the result from the computation context and losing invalid UTF8 sequences handled by converting the output to a string using <code>String::from_utf8_lossy</code>.</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">mut</span><span class="token plain"> output_buffer </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token macro property" style="color:rgb(12, 150, 155)">vec!</span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token number" style="color:rgb(170, 9, 130)">0u8</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token constant" style="color:rgb(72, 118, 214)">CTX_SIZE</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">get</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">unwrap</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">mut</span><span class="token plain"> output_size </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> context</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">get_output</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;</span><span class="token keyword" style="color:rgb(12, 150, 155)">mut</span><span class="token plain"> output_buffer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">expect</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Failed to get output tensor&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    output_size </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(12, 150, 155)">std</span><span class="token namespace punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token namespace" style="color:rgb(12, 150, 155)">cmp</span><span class="token namespace punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">min</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token constant" style="color:rgb(72, 118, 214)">CTX_SIZE</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">get</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">unwrap</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> output_size</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> output </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">String</span><span class="token punctuation" style="color:rgb(153, 76, 195)">::</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">from_utf8_lossy</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;</span><span class="token plain">output_buffer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token plain">output_size</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">to_string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Finally, print the prompt and the inference output to the console.</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token macro property" style="color:rgb(12, 150, 155)">println!</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;\nprompt: {}&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;</span><span class="token plain">prompt</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token macro property" style="color:rgb(12, 150, 155)">println!</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;\noutput: {}&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> output</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a href="#resources" class="hash-link" aria-label="Resources的直接連結" title="Resources的直接連結">​</a></h2><ul><li>If you&#x27;re looking for multi-turn conversations with llama 2 models, please check out the above mentioned chat example source code <a href="https://github.com/second-state/llamaedge/tree/main/chat" target="_blank" rel="noopener noreferrer">here</a>.</li><li>If you want to construct OpenAI-compatible APIs specifically for your llama2 model, or the Llama2 model itself, please check out the source code <a href="https://github.com/second-state/llamaedge/tree/main/api-server" target="_blank" rel="noopener noreferrer">for the API server</a>.</li><li>To learn more, please check out <a href="https://medium.com/stackademic/fast-and-portable-llama2-inference-on-the-heterogeneous-edge-a62508e82359" target="_blank" rel="noopener noreferrer">this article</a>.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wasmedge/docs/blob/main/docs/develop/rust/wasinn/llm_inference.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>編輯此頁</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件選項卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/zh-TW/category/ai-inference"><div class="pagination-nav__sublabel">上一頁</div><div class="pagination-nav__label">AI inference</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/zh-TW/develop/rust/wasinn/mediapipe"><div class="pagination-nav__sublabel">下一頁</div><div class="pagination-nav__label">Mediapipe solutions</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisite" class="table-of-contents__link toc-highlight">Prerequisite</a></li><li><a href="#quick-start" class="table-of-contents__link toc-highlight">Quick start</a></li><li><a href="#build-and-run" class="table-of-contents__link toc-highlight">Build and run</a></li><li><a href="#options" class="table-of-contents__link toc-highlight">Options</a></li><li><a href="#improving-performance" class="table-of-contents__link toc-highlight">Improving performance</a></li><li><a href="#understand-the-code" class="table-of-contents__link toc-highlight">Understand the code</a></li><li><a href="#resources" class="table-of-contents__link toc-highlight">Resources</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/zh-TW/start/overview">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/zh-TW/develop/overview">Develop</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/zh-TW/embed/overview">Embeds</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/zh-TW/contribute/overview">Contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/WasmEdge/WasmEdge" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.secondstate.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Second State<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.secondstate.io/articles/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Articles &amp; Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/zh-TW/talks">WasmEdge Talks</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/zh-TW/releases">Releases</a></li><li class="footer__item"><a href="https://wasmedge.org/docs/sitemap.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sitemap<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://groups.google.com/g/wasmedge/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mailing List<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/U4B5sFTkFc" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/realwasmedge" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://cloud-native.slack.com/archives/C0215BBK248" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack #WasmEdge<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docs.google.com/document/d/1iFlVl7R97Lze4RDykzElJGDjjWYDlkI8Rhf8g4dQ5Rk/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community Meeting<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://wasmedge.org/" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/docs/zh-TW/img/wasmedge_logo.svg" alt="WasmEdge logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/docs/zh-TW/img/wasmedge_logo.svg" alt="WasmEdge logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Copyright © 2024 WasmEdge. Built with Docusaurus. <br> <a href="https://github.com/WasmEdge/docs/blob/main/CODE_OF_CONDUCT.md" target="_blank">Code of Conduct</a></div></div></div></footer></div>
<script src="/docs/zh-TW/assets/js/runtime~main.8e325d4b.js"></script>
<script src="/docs/zh-TW/assets/js/main.98852c41.js"></script>
</body>
</html>