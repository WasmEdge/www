<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-develop/javascript/ssr">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Example: SSR | WasmEdge Developer Guides</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:image" content="https://wasmedge.org/docs/zh/./static/img/wasm_logo.png"><meta data-rh="true" property="og:url" content="https://wasmedge.org/docs/zh/develop/javascript/ssr"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="keywords" content="wasmedge, wasm, web assembly, rust, cncf, edge devices, cloud, serverless"><meta data-rh="true" name="og:title" content="WasmEdge"><meta data-rh="true" name="og:description" content="WasmEdge is a lightweight, high-performance, and extensible WebAssembly runtime for cloud native, edge, and decentralized applications. It powers serverless apps, embedded functions, microservices, smart contracts, and IoT devices."><meta data-rh="true" name="og:url" content="https://wasmedge.org/"><meta data-rh="true" name="og:type" content="Documentation"><meta data-rh="true" name="twitter:card" content="summary"><meta data-rh="true" name="twitter:image" content="summary_large_image"><meta data-rh="true" name="twitter:url" content="https://wasmedge.org/"><meta data-rh="true" name="twitter:site" content="@realwasmedge"><meta data-rh="true" name="twitter:title" content="WasmEdge"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Example: SSR | WasmEdge Developer Guides"><meta data-rh="true" name="description" content="React is a very popular JavaScript web UI framework. A React application is &quot;compiled&quot; into an HTML and JavaScript static website. The web UI is rendered through the generated JavaScript code. However, executing the complex generated JavaScript entirely in the browser is often too slow and resource consuming to build the interactive HTML DOM objects. React Server Side Rendering (SSR) delegates the JavaScript UI rendering to a server and has the server stream rendered HTML DOM objects to the browser. The WasmEdge JavaScript runtime provides a lightweight and high-performance container to run React SSR functions on edge servers."><meta data-rh="true" property="og:description" content="React is a very popular JavaScript web UI framework. A React application is &quot;compiled&quot; into an HTML and JavaScript static website. The web UI is rendered through the generated JavaScript code. However, executing the complex generated JavaScript entirely in the browser is often too slow and resource consuming to build the interactive HTML DOM objects. React Server Side Rendering (SSR) delegates the JavaScript UI rendering to a server and has the server stream rendered HTML DOM objects to the browser. The WasmEdge JavaScript runtime provides a lightweight and high-performance container to run React SSR functions on edge servers."><link data-rh="true" rel="icon" href="/docs/zh/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://wasmedge.org/docs/zh/develop/javascript/ssr"><link data-rh="true" rel="alternate" href="https://wasmedge.org/docs/develop/javascript/ssr" hreflang="en"><link data-rh="true" rel="alternate" href="https://wasmedge.org/docs/zh/develop/javascript/ssr" hreflang="zh"><link data-rh="true" rel="alternate" href="https://wasmedge.org/docs/zh-TW/develop/javascript/ssr" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://wasmedge.org/docs/develop/javascript/ssr" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Q77VSJHYQB"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-Q77VSJHYQB",{})</script><link rel="stylesheet" href="/docs/zh/assets/css/styles.c838d24b.css">
<link rel="preload" href="/docs/zh/assets/js/runtime~main.44970857.js" as="script">
<link rel="preload" href="/docs/zh/assets/js/main.023f9050.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like WasmEdge, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/WasmEdge/WasmEdge">GitHub</a>! ⭐️</div><button type="button" aria-label="关闭" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/zh/"><div class="navbar__logo"><img src="/docs/zh/img/logo.svg" alt="WasmEdge Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/zh/img/logo.svg" alt="WasmEdge Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">WasmEdge</b></a><a class="navbar__item navbar__link" href="/docs/zh/start/overview">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/zh/develop/overview">Develop</a><a class="navbar__item navbar__link" href="/docs/zh/embed/overview">Embed</a><a class="navbar__item navbar__link" href="/docs/zh/contribute/overview">Extend</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link icon-link language navbar__item"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/docs/develop/javascript/ssr" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/docs/zh/develop/javascript/ssr" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">简体中文</a></li><li><a href="/docs/zh-TW/develop/javascript/ssr" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-TW">中文（台灣）</a></li></ul></div><a href="https://github.com/WasmEdge/WasmEdge" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" alt="https://github.com/WasmEdge/WasmEdge"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/zh/develop/overview">Develop WASM Apps</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/zh/category/develop-wasm-apps-in-rust">Develop WASM Apps in Rust</a><button aria-label="打开/收起侧边栏菜单「Develop WASM Apps in Rust」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/zh/category/develop-wasm-apps-in-javascript">Develop WASM Apps in JavaScript</a><button aria-label="打开/收起侧边栏菜单「Develop WASM Apps in JavaScript」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh/develop/javascript/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh/develop/javascript/hello_world">Quickstart for JavaScript</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh/develop/javascript/networking">Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh/develop/javascript/tensorflow">AI inference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh/develop/javascript/nodejs">Node.js support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh/develop/javascript/es6">ES6 Modules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh/develop/javascript/modules">Built-in modules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh/develop/javascript/npm">NodeJS and NPM modules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh/develop/javascript/rust">Native JS API in Rust</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/zh/develop/javascript/ssr">Example: SSR</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/zh/category/develop-wasm-apps-in-cc">Develop WASM Apps in C/C++</a><button aria-label="打开/收起侧边栏菜单「Develop WASM Apps in C/C++」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/zh/category/develop-wasm-apps-in-go">Develop WASM Apps in Go</a><button aria-label="打开/收起侧边栏菜单「Develop WASM Apps in Go」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/zh/category/deploy-wasmedge-apps-in-kubernetes">Deploy WasmEdge apps in Kubernetes</a><button aria-label="打开/收起侧边栏菜单「Deploy WasmEdge apps in Kubernetes」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/zh/category/develop-wasm-apps-in-python">Develop WASM Apps in Python</a><button aria-label="打开/收起侧边栏菜单「Develop WASM Apps in Python」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/docs/zh/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/zh/category/develop-wasm-apps-in-javascript"><span itemprop="name">Develop WASM Apps in JavaScript</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Example: SSR</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>Example: SSR</h1><p><a href="https://reactjs.org/" target="_blank" rel="noopener noreferrer">React</a> is a very popular JavaScript web UI framework. A React application is &quot;compiled&quot; into an HTML and JavaScript static website. The web UI is rendered through the generated JavaScript code. However, executing the complex generated JavaScript entirely in the browser is often too slow and resource consuming to build the interactive HTML DOM objects. <a href="https://medium.com/jspoint/a-beginners-guide-to-react-server-side-rendering-ssr-bf3853841d55" target="_blank" rel="noopener noreferrer">React Server Side Rendering (SSR)</a> delegates the JavaScript UI rendering to a server and has the server stream rendered HTML DOM objects to the browser. The WasmEdge JavaScript runtime provides a lightweight and high-performance container to run React SSR functions on edge servers.</p><p>Server-side rendering (SSR) is a popular technique for rendering a client-side single-page application (SPA) on the server and then sending a fully rendered page to the client, allowing dynamic components to be served as static HTML markup. This approach can be useful for search engine optimization (SEO) when indexing does not handle JavaScript properly. It may also be beneficial when downloading a large JavaScript bundle is impaired by a slow network. -- <a href="https://www.digitalocean.com/community/tutorials/react-server-side-rendering" target="_blank" rel="noopener noreferrer">from Digital Ocean</a>.</p><p>This article will show you how to use the WasmEdge QuickJS runtime to implement a React SSR function. Compared with the Docker + Linux + nodejs + v8 approach, WasmEdge is safer (suitable for multi-tenancy environments) and much lighter (1% of the footprint) with similar performance.</p><p>We will start with a complete tutorial to create and deploy a simple React Streaming SSR web application and then move on to a full React 18 demo.</p><ul><li><a href="#getting-started">Getting started with React streaming SSR</a></li><li><a href="#a-full-react-18-app">A full React 18 app</a></li><li><a href="#appendix-the-create-react-app-template">Appendix: the create-react-app template</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started">Getting started<a href="#getting-started" class="hash-link" aria-label="Getting started的直接链接" title="Getting started的直接链接">​</a></h2><p>The <a href="https://github.com/second-state/wasmedge-quickjs/tree/main/example_js/react_ssr_stream" target="_blank" rel="noopener noreferrer">example_js/react_ssr_stream</a> folder in the GitHub repo contains the example&#x27;s source code. It showcases how to render an HTML string from templates in a JavaScript app in WasmEdge.</p><p>The <a href="https://github.com/second-state/wasmedge-quickjs/blob/main/example_js/react_ssr_stream/component/LazyHome.jsx" target="_blank" rel="noopener noreferrer">component/LazyHome.jsx</a> file is the main page template in React. It &quot;lazy&quot; loads the inner page template after a 2s delay once the outer HTML is rendered and returned to the user.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> React</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> Suspense </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;react&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">as</span><span class="token plain"> LazyPage </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;./LazyPage.jsx&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">sleep</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token parameter">ms</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Promise</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token parameter">r</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token parameter"> _</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">setTimeout</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">r</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> ms</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">loadLazyPage</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">sleep</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">2000</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> LazyPage</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">LazyHome</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">extends</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">React</span><span class="token class-name punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token class-name" style="color:rgb(17, 17, 17)">Component</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">render</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> LazyPage1 </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> React</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">lazy</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">loadLazyPage</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">html lang</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;en&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">head</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">meta charSet</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;utf-8&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">title</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">Title</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token plain">title</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token plain">head</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">body</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"> This is LazyHome </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token plain">div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">Suspense fallback</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"> loading</span><span class="token operator" style="color:rgb(12, 150, 155)">...</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token plain">div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">              </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">LazyPage1 </span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token plain">Suspense</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token plain">div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token plain">body</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token plain">html</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">default</span><span class="token plain"> LazyHome</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <a href="https://github.com/second-state/wasmedge-quickjs/blob/main/example_js/react_ssr_stream/component/LazyPage.jsx" target="_blank" rel="noopener noreferrer">LazyPage.jsx</a> is the inner page template. It is rendered 2s after the outer page is already returned to the user.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> React </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;react&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">LazyPage</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">extends</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">React</span><span class="token class-name punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token class-name" style="color:rgb(17, 17, 17)">Component</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">render</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">This is lazy page</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token plain">div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token plain">div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">default</span><span class="token plain"> LazyPage</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <a href="https://github.com/second-state/wasmedge-quickjs/blob/main/example_js/react_ssr_stream/main.mjs" target="_blank" rel="noopener noreferrer">main.mjs</a> file starts a non-blocking HTTP server using standard Node.js APIs, and then renders the HTML page in multiple chunks to the response.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">as</span><span class="token plain"> React </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;react&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> renderToPipeableStream </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;react-dom/server&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> createServer </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;http&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> LazyHome </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;./component/LazyHome.jsx&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">createServer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  res</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">setHeader</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;Content-type&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;text/html; charset=utf-8&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">renderToPipeableStream</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">LazyHome </span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">pipe</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">res</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">listen</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">8001</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">print</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;listen 8001...&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <a href="https://github.com/second-state/wasmedge-quickjs/blob/main/example_js/react_ssr_stream/rollup.config.js" target="_blank" rel="noopener noreferrer">rollup.config.js</a> and <a href="https://github.com/second-state/wasmedge-quickjs/blob/main/example_js/react_ssr_stream/package.json" target="_blank" rel="noopener noreferrer">package.json</a> files are to build the React SSR dependencies and components into a bundled JavaScript file for WasmEdge. You should use the <code>npm</code> command to build it. The output is in the <code>dist/main.mjs</code> file.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">install</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">npm</span><span class="token plain"> run build</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Copy over the system&#x27;s <code>modules</code> to the working directory for Node.js API support as <a href="/docs/zh/develop/javascript/nodejs">noted here</a>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">cp</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">-r</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token plain">/</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token plain">/modules </span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To run the example, do the following on the CLI to start the server.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">nohup</span><span class="token plain"> wasmedge </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">--dir</span><span class="token plain"> .:. /path/to/wasmedge_quickjs.wasm dist/main.mjs </span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Send the server an HTTP request via <code>curl</code> or the browser.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">curl</span><span class="token plain"> http://localhost:8001</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The results are as follows. The service returns an HTML page with an empty inner section (i.e., the <code>loading</code> section), then 2s later, the HTML content for the inner section and the JavaScript to display.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                                 Dload  Upload   Total   Spent    Left  Speed</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> --:--:-- --:--:-- --:--:--     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token number" style="color:rgb(170, 9, 130)">100</span><span class="token plain">   </span><span class="token number" style="color:rgb(170, 9, 130)">211</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">   </span><span class="token number" style="color:rgb(170, 9, 130)">211</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">   </span><span class="token number" style="color:rgb(170, 9, 130)">1029</span><span class="token plain">      </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> --:--:-- --:--:-- --:--:--  </span><span class="token number" style="color:rgb(170, 9, 130)">1024</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token number" style="color:rgb(170, 9, 130)">100</span><span class="token plain">   </span><span class="token number" style="color:rgb(170, 9, 130)">275</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">   </span><span class="token number" style="color:rgb(170, 9, 130)">275</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">221</span><span class="token plain">      </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> --:--:--  </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">:00:01 --:--:--   </span><span class="token number" style="color:rgb(170, 9, 130)">220</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token number" style="color:rgb(170, 9, 130)">100</span><span class="token plain">   </span><span class="token number" style="color:rgb(170, 9, 130)">547</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">   </span><span class="token number" style="color:rgb(170, 9, 130)">547</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">245</span><span class="token plain">      </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> --:--:--  </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">:00:02 --:--:--   </span><span class="token number" style="color:rgb(170, 9, 130)">245</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token number" style="color:rgb(170, 9, 130)">100</span><span class="token plain">  </span><span class="token number" style="color:rgb(170, 9, 130)">1020</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">  </span><span class="token number" style="color:rgb(170, 9, 130)">1020</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">413</span><span class="token plain">      </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> --:--:--  </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">:00:02 --:--:--   </span><span class="token number" style="color:rgb(170, 9, 130)">413</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">DOCTYPE html</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">html </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">lang</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;en&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">head</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">meta </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">charSet</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;utf-8&quot;</span><span class="token plain">/</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">title</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">Title</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/title</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/head</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">body</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"> This is LazyHome </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">--</span><span class="token variable" style="color:rgb(201, 103, 101)">$?</span><span class="token plain">--</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">template </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;B:0&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/template</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"> loading</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token plain">. </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">--/$--</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/body</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/html</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div hidden </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;S:0&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">template </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;P:1&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/template</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div hidden </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;S:1&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">This is lazy page</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">function </span><span class="token variable" style="color:rgb(201, 103, 101)">$RS</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">a,b</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">a</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">document.getElementById</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">b</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">document.getElementById</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">for</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">a.parentNode.removeChild</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">a.firstChild</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">b.parentNode.insertBefore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">a.firstChild,b</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">b.parentNode.removeChild</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token variable" style="color:rgb(201, 103, 101)">$RS</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;S:1&quot;</span><span class="token plain">,</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;P:1&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">function </span><span class="token variable" style="color:rgb(201, 103, 101)">$RC</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">a,b</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">a</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">document.getElementById</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">b</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">document.getElementById</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">b.parentNode.removeChild</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">if</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">a</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">a.previousSibling</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">var </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">f</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">a.parentNode,c</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">a.nextSibling,e</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">do</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">if</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">c</span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;&amp;</span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">8</span><span class="token operator" style="color:rgb(12, 150, 155)">==</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">c.nodeType</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">var </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">d</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">c.data</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">if</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/$&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">==</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">d</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">if</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token operator" style="color:rgb(12, 150, 155)">==</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">break</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token keyword" style="color:rgb(12, 150, 155)">else</span><span class="token plain"> e--</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token keyword" style="color:rgb(12, 150, 155)">else</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;$&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">!=</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">d</span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;&amp;</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;</span><span class="token string variable" style="color:rgb(201, 103, 101)">$?</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">!=</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">d</span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;&amp;</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;</span><span class="token string variable" style="color:rgb(201, 103, 101)">$!</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">!=</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">d</span><span class="token operator" style="color:rgb(12, 150, 155)">||</span><span class="token plain">e++</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain">d</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">c.nextSibling</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">f.removeChild</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">c</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">d</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain">while</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">for</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">b.firstChild</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">f.insertBefore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">b.firstChild,c</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">a.data</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;$&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">a._reactRetry</span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;&amp;</span><span class="token plain">a._reactRetry</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token variable" style="color:rgb(201, 103, 101)">$RC</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;B:0&quot;</span><span class="token plain">,</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;S:0&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-full-react-18-app">A full React 18 app<a href="#a-full-react-18-app" class="hash-link" aria-label="A full React 18 app的直接链接" title="A full React 18 app的直接链接">​</a></h2><p>In this section, we will demonstrate a complete React 18 SSR application. It renders the web UI through streaming SSR. The <a href="https://github.com/second-state/wasmedge-quickjs/tree/main/example_js/react18_ssr" target="_blank" rel="noopener noreferrer">example_js/react18_ssr</a> folder in the GitHub repo contains the example&#x27;s source code. The <a href="https://github.com/second-state/wasmedge-quickjs/tree/main/example_js/react18_ssr/component" target="_blank" rel="noopener noreferrer">component</a> folder contains the entire React 18 application&#x27;s source code, and the <a href="https://github.com/second-state/wasmedge-quickjs/tree/main/example_js/react18_ssr/public" target="_blank" rel="noopener noreferrer">public</a> folder contains the public resources (CSS and images) for the web application. The application also demonstrates a data provider for the UI.</p><p>The <a href="https://github.com/second-state/wasmedge-quickjs/blob/main/example_js/react18_ssr/main.mjs" target="_blank" rel="noopener noreferrer">main.mjs</a> file starts a non-blocking HTTP server, fetches data from a data provider, maps the <code>main.css</code> and <code>main.js</code> files in the <code>public</code> folder to web URLs, and then renders the HTML page for each request in <code>renderToPipeableStream()</code>.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">as</span><span class="token plain"> React </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;react&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> renderToPipeableStream </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;react-dom/server&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> createServer </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;http&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">as</span><span class="token plain"> std </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;std&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> App </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;./component/App.js&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> DataProvider </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;./component/data.js&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> assets </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token string-property property" style="color:rgb(12, 150, 155)">&#x27;main.js&#x27;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;/main.js&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token string-property property" style="color:rgb(12, 150, 155)">&#x27;main.css&#x27;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;/main.css&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> css </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> std</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">loadFile</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;./public/main.css&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">createServerData</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> done </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">false</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> promise </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">null</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">read</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">done</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token keyword" style="color:rgb(12, 150, 155)">return</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">promise</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token keyword" style="color:rgb(12, 150, 155)">throw</span><span class="token plain"> promise</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      promise </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Promise</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token parameter">resolve</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">setTimeout</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          done </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          promise </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">null</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">resolve</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">2000</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token keyword" style="color:rgb(12, 150, 155)">throw</span><span class="token plain"> promise</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">createServer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">print</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">req</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">req</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">url </span><span class="token operator" style="color:rgb(12, 150, 155)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;/main.css&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    res</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">setHeader</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;Content-Type&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;text/css; charset=utf-8&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    res</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">end</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">css</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">req</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">url </span><span class="token operator" style="color:rgb(12, 150, 155)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;/favicon.ico&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    res</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">end</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    res</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">setHeader</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;Content-type&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;text/html&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    res</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">on</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;error&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token parameter">e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">print</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;res error&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> data </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">createServerData</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">print</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;createServerData&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> stream </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">renderToPipeableStream</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">DataProvider data</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">App assets</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">assets</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token plain">DataProvider</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token function-variable function" style="color:rgb(153, 76, 195);font-style:italic">onShellReady</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          stream</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">pipe</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">res</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token function-variable function" style="color:rgb(153, 76, 195);font-style:italic">onShellError</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token parameter">e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">          </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">print</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;onShellError:&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">listen</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">8002</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">print</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;listen 8002...&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <a href="https://github.com/second-state/wasmedge-quickjs/blob/main/example_js/react18_ssr/rollup.config.js" target="_blank" rel="noopener noreferrer">rollup.config.js</a> and <a href="https://github.com/second-state/wasmedge-quickjs/blob/main/example_js/react18_ssr/package.json" target="_blank" rel="noopener noreferrer">package.json</a> files are to build the React 18 SSR dependencies and components into a bundled JavaScript file for WasmEdge. You should use the <code>npm</code> command to build it. The output is in the <code>dist/main.mjs</code> file.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">install</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">npm</span><span class="token plain"> run build</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Copy over the system&#x27;s <code>modules</code> to the working directory for Node.js API support as <a href="/docs/zh/develop/javascript/nodejs">noted here</a>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">cp</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">-r</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token plain">/</span><span class="token punctuation" style="color:rgb(153, 76, 195)">..</span><span class="token plain">/modules </span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To run the example, do the following on the CLI to start the server.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">nohup</span><span class="token plain"> wasmedge </span><span class="token parameter variable" style="color:rgb(201, 103, 101)">--dir</span><span class="token plain"> .:. /path/to/wasmedge_quickjs.wasm dist/main.mjs </span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Send the server an HTTP request via <code>curl</code> or the browser.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">curl</span><span class="token plain"> http://localhost:8002</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The results are as follows. The service returns an HTML page with an empty inner section (i.e., the <code>loading</code> section), and then 2s later, the HTML content for the inner section and the JavaScript to display it.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">                                 Dload  Upload   Total   Spent    Left  Speed</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">      </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> --:--:-- --:--:-- --:--:--     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token number" style="color:rgb(170, 9, 130)">100</span><span class="token plain">   </span><span class="token number" style="color:rgb(170, 9, 130)">439</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">   </span><span class="token number" style="color:rgb(170, 9, 130)">439</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">   </span><span class="token number" style="color:rgb(170, 9, 130)">1202</span><span class="token plain">      </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> --:--:-- --:--:-- --:--:--  </span><span class="token number" style="color:rgb(170, 9, 130)">1199</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token number" style="color:rgb(170, 9, 130)">100</span><span class="token plain">  </span><span class="token number" style="color:rgb(170, 9, 130)">2556</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">  </span><span class="token number" style="color:rgb(170, 9, 130)">2556</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">   </span><span class="token number" style="color:rgb(170, 9, 130)">1150</span><span class="token plain">      </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> --:--:--  </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">:00:02 --:--:--  </span><span class="token number" style="color:rgb(170, 9, 130)">1150</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token number" style="color:rgb(170, 9, 130)">100</span><span class="token plain">  </span><span class="token number" style="color:rgb(170, 9, 130)">2556</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">  </span><span class="token number" style="color:rgb(170, 9, 130)">2556</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">926</span><span class="token plain">      </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> --:--:--  </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">:00:02 --:--:--   </span><span class="token number" style="color:rgb(170, 9, 130)">926</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token number" style="color:rgb(170, 9, 130)">100</span><span class="token plain">  </span><span class="token number" style="color:rgb(170, 9, 130)">2806</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">  </span><span class="token number" style="color:rgb(170, 9, 130)">2806</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">     </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">    </span><span class="token number" style="color:rgb(170, 9, 130)">984</span><span class="token plain">      </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"> --:--:--  </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain">:00:02 --:--:--   </span><span class="token number" style="color:rgb(170, 9, 130)">984</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">DOCTYPE html</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">html </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">lang</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;en&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">head</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">meta </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">charSet</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;utf-8&quot;</span><span class="token plain">/</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">meta </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">name</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;viewport</span><br></span><span class="token-line" style="color:#403f53"><span class="token string" style="color:rgb(72, 118, 214)">&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">content</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;width=device-width, initial-scale=1&quot;</span><span class="token plain">/</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">link </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">rel</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;stylesheet&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">href</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/m</span><br></span><span class="token-line" style="color:#403f53"><span class="token string" style="color:rgb(72, 118, 214)">ain.css&quot;</span><span class="token plain">/</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">title</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">Hello</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/title</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/head</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">body</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">noscript</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">b</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">Enable JavaScript to run</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"> this app.</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/b</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/noscript</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">--$--</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">main</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">nav</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">a </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">href</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">Home</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/a</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/nav</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">aside cla</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">ss</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;sidebar&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">--</span><span class="token variable" style="color:rgb(201, 103, 101)">$?</span><span class="token plain">--</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">template </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;B:0&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/template</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">class</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;spinner spinner-</span><br></span><span class="token-line" style="color:#403f53"><span class="token string" style="color:rgb(72, 118, 214)">-active&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">role</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;progressbar&quot;</span><span class="token plain"> aria-busy</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;true&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">--/$--</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/aside</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">article cla</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">ss</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;post&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">--</span><span class="token variable" style="color:rgb(201, 103, 101)">$?</span><span class="token plain">--</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">template </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;B:1&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/template</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">class</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;spinner spinner--ac</span><br></span><span class="token-line" style="color:#403f53"><span class="token string" style="color:rgb(72, 118, 214)">tive&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">role</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;progressbar&quot;</span><span class="token plain"> aria-busy</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;true&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">--/$--</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">section </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">class</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;comment</span><br></span><span class="token-line" style="color:#403f53"><span class="token string" style="color:rgb(72, 118, 214)">s&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">h</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">2</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">Comments</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/h</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">2</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">--</span><span class="token variable" style="color:rgb(201, 103, 101)">$?</span><span class="token plain">--</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">template </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;B:2&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/template</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">class</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;spinner s</span><br></span><span class="token-line" style="color:#403f53"><span class="token string" style="color:rgb(72, 118, 214)">pinner--active&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">role</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;progressbar&quot;</span><span class="token plain"> aria-busy</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;true&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">--/$--</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/section</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">h2</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">Thanks </span><span class="token keyword" style="color:rgb(12, 150, 155)">for</span><span class="token plain"> reading</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/h</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">2</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/article</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/main</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">--/$--</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">assetManifest </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;mai</span><br></span><span class="token-line" style="color:#403f53"><span class="token string" style="color:rgb(72, 118, 214)">n.js&quot;</span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">:</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/main.js&quot;</span><span class="token plain">,</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;main.css&quot;</span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">:</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/main.css&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/body</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/html</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div hidden </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;</span><br></span><span class="token-line" style="color:#403f53"><span class="token string" style="color:rgb(72, 118, 214)">S:0&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">template </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;P:3&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/template</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div hidden </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;S:1&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">template </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;P:4&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/template</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div hidden </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;S:2&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">template </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;P:5&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/template</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">hidden </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;S:3&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">h</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">1</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">Archive</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/h</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">1</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">ul</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">May </span><span class="token number" style="color:rgb(170, 9, 130)">202</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">1</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">April </span><span class="token number" style="color:rgb(170, 9, 130)">202</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">1</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">Marc</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">h </span><span class="token number" style="color:rgb(170, 9, 130)">202</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">1</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">February </span><span class="token number" style="color:rgb(170, 9, 130)">202</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">1</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">January </span><span class="token number" style="color:rgb(170, 9, 130)">202</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">1</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">December </span><span class="token number" style="color:rgb(170, 9, 130)">202</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">0</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">November </span><span class="token number" style="color:rgb(170, 9, 130)">202</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">0</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">October </span><span class="token number" style="color:rgb(170, 9, 130)">202</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">0</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">September </span><span class="token number" style="color:rgb(170, 9, 130)">202</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">0</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/li</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/ul</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">script</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">function </span><span class="token variable" style="color:rgb(201, 103, 101)">$RS</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">a,b</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">a</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">document.getElementById</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">b</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">document.getElementById</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token keyword" style="color:rgb(12, 150, 155)">for</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">a.parentNode.removeChild</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">a.firstChild</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">b.parentNode.insertBefore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">a.firstChil</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">d,b</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">b.parentNode.removeChild</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token variable" style="color:rgb(201, 103, 101)">$RS</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;S:3&quot;</span><span class="token plain">,</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;P:3&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">function </span><span class="token variable" style="color:rgb(201, 103, 101)">$RC</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">a,b</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">a</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">document.getElementById</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">b</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">document.getElementById</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">b.parentNode.remo</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">veChild</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">if</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">a</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">a.previousSibling</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">var </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">f</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">a.parentNode,c</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">a.nextSibling,e</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">do</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">i</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">f</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">c</span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;&amp;</span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">8</span><span class="token operator" style="color:rgb(12, 150, 155)">==</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">c.nodeType</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">var </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">d</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">c.data</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">if</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/$&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">==</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">d</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">if</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token operator" style="color:rgb(12, 150, 155)">==</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">break</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token keyword" style="color:rgb(12, 150, 155)">else</span><span class="token plain"> e--</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token keyword" style="color:rgb(12, 150, 155)">else</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;$&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">!=</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">d</span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;&amp;</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;</span><span class="token string variable" style="color:rgb(201, 103, 101)">$?</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">!=</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">d</span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;&amp;</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;</span><span class="token string variable" style="color:rgb(201, 103, 101)">$!</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">!=</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">d</span><span class="token operator" style="color:rgb(12, 150, 155)">||</span><span class="token plain">e++</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain">d</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">c.nextSibling</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">f.removeChild</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">c</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">d</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain">while</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">for</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">b.</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">firstChild</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">f.insertBefore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">b.firstChild,c</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">a.data</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;$&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">a._reactRetry</span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;&amp;</span><span class="token plain">a._reactRet</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">ry</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token variable" style="color:rgb(201, 103, 101)">$RC</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;B:0&quot;</span><span class="token plain">,</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;S:0&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div hidden </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;S:4&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">h</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">1</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">Hello world</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/h</span><span class="token operator file-descriptor important" style="color:rgb(12, 150, 155)">1</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">p</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">This</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"> demo is </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">-- --</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">b</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">artificially slowed down</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/b</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">. Open</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">-- --</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">-- --</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">code</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">ser</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">ver/delays.js</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/code</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"> to adjust how much different things are slowed down.</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain">-- --</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/p</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">p</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">Notice how HTML </span><span class="token keyword" style="color:rgb(12, 150, 155)">for</span><span class="token plain"> comments </span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;</span><span class="token plain">quot</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain">streams </span><span class="token keyword" style="color:rgb(12, 150, 155)">in</span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;</span><span class="token plain">quot</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"> before the JS </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">or Re</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">act</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> has loaded on the page.</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/p</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">p</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">Also notice that the JS </span><span class="token keyword" style="color:rgb(12, 150, 155)">for</span><span class="token plain"> comments and side</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">bar has been code-split, but HTML </span><span class="token keyword" style="color:rgb(12, 150, 155)">for</span><span class="token plain"> it is still included </span><span class="token keyword" style="color:rgb(12, 150, 155)">in</span><span class="token plain"> the server output.</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/p</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token variable" style="color:rgb(201, 103, 101)">$RS</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;S:4&quot;</span><span class="token plain">,</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;P:4&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token variable" style="color:rgb(201, 103, 101)">$RC</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;B:1&quot;</span><span class="token plain">,</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;S:1&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">div</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"> hidden </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;S:5&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">p </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">class</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;comment&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">Wait, it doesn</span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;</span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">#x27;t wait for React to load</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">?</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/p</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">p </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">class</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;comment&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">How does this even work?</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/p</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">p </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">class</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;comment&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain">I like ma</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">rshmallows</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/p</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/div</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token variable" style="color:rgb(201, 103, 101)">$RS</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;S:5&quot;</span><span class="token plain">,</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;P:5&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token variable" style="color:rgb(201, 103, 101)">$RC</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;B:2&quot;</span><span class="token plain">,</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;S:2&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">/s</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">cript</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The streaming SSR examples make use of WasmEdge&#x27;s unique asynchronous networking capabilities and ES6 module support (i.e., the roll-up bundled JS file contains ES6 modules). You can learn more about <a href="/docs/zh/develop/javascript/networking">async networking</a> and <a href="/docs/zh/develop/javascript/es6">ES6</a> in this book.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="appendix-the-create-react-app-template">Appendix the create-react-app template<a href="#appendix-the-create-react-app-template" class="hash-link" aria-label="Appendix the create-react-app template的直接链接" title="Appendix the create-react-app template的直接链接">​</a></h2><p>The <code>create-react-app</code> template is a popular starting point for many developers to create React apps. In this tutorial, we will provide a step-by-step guide on how to use it to create React streaming SSR applications that run on WasmEdge.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1--create-the-react-app">Step 1 — Create the React App<a href="#step-1--create-the-react-app" class="hash-link" aria-label="Step 1 — Create the React App的直接链接" title="Step 1 — Create the React App的直接链接">​</a></h3><p>First, use <code>npx</code> to create a new React app. Let’s name the app <code>react-ssr-example</code>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">npx create-react-app react-ssr-example</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, <code>cd</code> into the directory for the newly created app.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token builtin class-name" style="color:rgb(17, 17, 17)">cd</span><span class="token plain"> react-ssr-example</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Start the new app to verify the installation.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">npm</span><span class="token plain"> start</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should see the example React app displayed in your browser window. At this stage, the app is rendered in the browser. The browser runs the generated React JavaScript to build the HTML DOM UI.</p><p>Now to prepare for SSR, you will need to make some changes to the app&#x27;s <code>index.js</code> file. Change ReactDOM&#x27;s <code>render</code> method to <code>hydrate</code> to indicate to the DOM renderer that you intend to rehydrate the app after it is rendered on the server. Replace the contents of the <code>index.js</code> file with the following.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> React </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;react&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> ReactDOM </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;react-dom&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> App </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;./App&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">ReactDOM</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">hydrate</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">React</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">StrictMode</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">App </span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token plain">React</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">StrictMode</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  document</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">getElementById</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;root&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>备注</div><div class="admonitionContent_S0QG"><p>You should import <code>React</code> redundantly in the <code>src/App.js</code>, so the server will recognize it.</p></div></div><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> React </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;react&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">//...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>That concludes setting up the application. You can move on to setting up the server-side rendering functions.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2--create-an-wasmedge-quickjs-server-and-render-the-app-component">Step 2 — Create an WasmEdge QuickJS Server and Render the App Component<a href="#step-2--create-an-wasmedge-quickjs-server-and-render-the-app-component" class="hash-link" aria-label="Step 2 — Create an WasmEdge QuickJS Server and Render the App Component的直接链接" title="Step 2 — Create an WasmEdge QuickJS Server and Render the App Component的直接链接">​</a></h3><p>Now that you have the app in place let’s set up a server that will render the HTML DOM by running the React JavaScript and then send the rendered elements to the browser. We will use WasmEdge as a secure, high-performance, lightweight container to run React JavaScript.</p><p>Create a new <code>server</code> directory in the project&#x27;s root directory.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">mkdir</span><span class="token plain"> server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, inside the <code>server</code> directory, create a new <code>index.js</code> file with the server code.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">as</span><span class="token plain"> React </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;react&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> ReactDOMServer </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;react-dom/server&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">as</span><span class="token plain"> std </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;std&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">as</span><span class="token plain"> http </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;wasi_http&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">as</span><span class="token plain"> net </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;wasi_net&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> App </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;../src/App.js&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">handle_client</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token parameter">cs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">print</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;open:&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> cs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">peer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> buffer </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">http</span><span class="token class-name punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token class-name" style="color:rgb(17, 17, 17)">Buffer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> d </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">await</span><span class="token plain"> cs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">read</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">d </span><span class="token operator" style="color:rgb(12, 150, 155)">==</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">undefined</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">||</span><span class="token plain"> d</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">byteLength </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token keyword" style="color:rgb(12, 150, 155)">return</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      buffer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">append</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">d</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> req </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">parseRequest</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">req </span><span class="token keyword" style="color:rgb(12, 150, 155)">instanceof</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">http</span><span class="token class-name punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token class-name" style="color:rgb(17, 17, 17)">WasiRequest</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">handle_req</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">cs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> req</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token keyword" style="color:rgb(12, 150, 155)">break</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">print</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">print</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;end:&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> cs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">peer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">enlargeArray</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token parameter">oldArr</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token parameter"> newLength</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> newArr </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Uint8Array</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">newLength</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  oldArr </span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;&amp;</span><span class="token plain"> newArr</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">set</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">oldArr</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> newArr</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">handle_req</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token parameter">s</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token parameter"> req</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">print</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;uri:&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> req</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">uri</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> resp </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">http</span><span class="token class-name punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token class-name" style="color:rgb(17, 17, 17)">WasiResponse</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> content </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">req</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">uri </span><span class="token operator" style="color:rgb(12, 150, 155)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;/&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> app </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> ReactDOMServer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">renderToString</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">App </span><span class="token operator" style="color:rgb(12, 150, 155)">/</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    content </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> std</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">loadFile</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;./build/index.html&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    content </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> content</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">replace</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token template-string template-punctuation string" style="color:rgb(72, 118, 214)">`</span><span class="token template-string string" style="color:rgb(72, 118, 214)">&lt;div id=&quot;root&quot;&gt;</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(153, 76, 195)">${</span><span class="token template-string interpolation">app</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token template-string string" style="color:rgb(72, 118, 214)">&lt;/div&gt;</span><span class="token template-string template-punctuation string" style="color:rgb(72, 118, 214)">`</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> chunk </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">1000</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Chunk size of each reading</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> length </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// The whole length of the file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> byteArray </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">null</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// File content as Uint8Array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Read file into byteArray by chunk</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> file </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> std</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">open</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;./build&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">+</span><span class="token plain"> req</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">uri</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;r&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      byteArray </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">enlargeArray</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">byteArray</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> length </span><span class="token operator" style="color:rgb(12, 150, 155)">+</span><span class="token plain"> chunk</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> readLen </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> file</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">read</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">byteArray</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">buffer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> length</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> chunk</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      length </span><span class="token operator" style="color:rgb(12, 150, 155)">+=</span><span class="token plain"> readLen</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">readLen </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain"> chunk</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token keyword" style="color:rgb(12, 150, 155)">break</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    content </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> byteArray</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">slice</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> length</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">buffer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    file</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">close</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> contentType </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;text/html; charset=utf-8&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">req</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">uri</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">endsWith</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;.css&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    contentType </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;text/css; charset=utf-8&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">req</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">uri</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">endsWith</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;.js&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    contentType </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;text/javascript; charset=utf-8&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">req</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">uri</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">endsWith</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;.json&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    contentType </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;text/json; charset=utf-8&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">req</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">uri</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">endsWith</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;.ico&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    contentType </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;image/vnd.microsoft.icon&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">req</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">uri</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">endsWith</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;.png&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    contentType </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;image/png&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  resp</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">headers </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token string-property property" style="color:rgb(12, 150, 155)">&#x27;Content-Type&#x27;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> contentType</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> r </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> resp</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">encode</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">content</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  s</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">write</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">server_start</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">print</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;listen 8002...&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">net</span><span class="token class-name punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token class-name" style="color:rgb(17, 17, 17)">WasiTcpServer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">8002</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token keyword" style="color:rgb(12, 150, 155)">var</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(12, 150, 155)">++</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token keyword" style="color:rgb(12, 150, 155)">let</span><span class="token plain"> cs </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">await</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">accept</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">handle_client</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">cs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">print</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">server_start</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The server renders the <code>&lt;App&gt;</code> component and then sends the rendered HTML string back to the browser. Three important things are taking place here.</p><ul><li>ReactDOMServer&#x27;s <code>renderToString</code> is used to render the <code>&lt;App/&gt;</code> to an HTML string.</li><li>The <code>index.html</code> file from the app&#x27;s <code>build</code> output directory is loaded as a template. The app&#x27;s content is injected into the <code>&lt;div&gt;</code> element with an id of <code>&quot;root&quot;</code>. It is then sent back as HTTP response.</li><li>Other files from the <code>build</code> directory are read and served as needed at the requests of the browser.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3--build-and-deploy">Step 3 — Build and deploy<a href="#step-3--build-and-deploy" class="hash-link" aria-label="Step 3 — Build and deploy的直接链接" title="Step 3 — Build and deploy的直接链接">​</a></h3><p>For the server code to work, you will need to bundle and transpile it. This section will show you how to use Webpack and Babel. This next section will demonstrate an alternative (and potentially easier) approach using rollup.js.</p><p>Create a new Babel configuration file named <code>.babelrc.json</code> in the project&#x27;s root directory and add the <code>env</code> and <code>react-app</code> presets.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;presets&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;@babel/preset-env&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;@babel/preset-react&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Create a webpack config for the server that uses Babel Loader to transpile the code. Create the <code>webpack.server.js</code> file in the project&#x27;s root directory.</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">require</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;path&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">exports </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">entry</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;./server/index.js&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">externals</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">wasi_http</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;wasi_http&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">wasi_net</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;wasi_net&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">std</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;std&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">output</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">path</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">resolve</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;server-build&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">filename</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;index.js&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">chunkFormat</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;module&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">library</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">type</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;module&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">experiments</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">outputModule</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">module</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">rules</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">test</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\.js$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">use</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;babel-loader&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">test</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\.css$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">use</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;css-loader&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">test</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\.svg$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">use</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;svg-url-loader&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With this configuration, the transpired server bundle will be output to the <code>server-build</code> folder in a file called <code>index.js</code>.</p><p>Next, add the <code>svg-url-loader</code> package by entering the following commands in your terminal.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">install</span><span class="token plain"> svg-url-loader --save-dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This completes the dependency installation and webpack and Babel configuration.</p><p>Now, revisit <code>package.json</code> and add helper npm scripts. Add <code>dev:build-server</code>, <code>dev:start-server</code> scripts to the <code>package.json</code> file to build and serve the SSR application.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token property" style="color:rgb(12, 150, 155)">&quot;scripts&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;dev:build-server&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;NODE_ENV=development webpack --config webpack.server.js --mode=development&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;dev:start-server&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;wasmedge --dir .:. wasmedge_quickjs.wasm ./server-build/index.js&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>The <code>dev:build-server</code> script sets the environment to <code>&quot;development&quot;</code> and invokes webpack with the configuration file you created earlier.</li><li>The <code>dev:start-server</code> script runs the WasmEdge server from the <code>wasmedge</code> CLI tool to serve the built output. The <code>wasmedge_quickjs.wasm</code> program contains the QuickJS runtime. <a href="/docs/zh/develop/javascript/hello_world">Learn more</a></li></ul><p>Now you can run the following commands to build the client-side app, bundle and transpile the server code, and start the server on <code>:8002</code>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">npm</span><span class="token plain"> run build</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">npm</span><span class="token plain"> run dev:build-server</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">npm</span><span class="token plain"> run dev:start-server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Open <code>http://localhost:8002/</code> in your web browser and observe your server-side rendered app.</p><p>Previously, the HTML source in the browser is simply the template with SSR placeholders.</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">Output</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&lt;</span><span class="token tag" style="color:rgb(153, 76, 195)">div</span><span class="token tag" style="color:rgb(153, 76, 195)"> </span><span class="token tag attr-name" style="color:rgb(72, 118, 214);font-style:italic">id</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(153, 76, 195)">=</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag attr-value" style="color:rgb(153, 76, 195)">root</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&lt;/</span><span class="token tag" style="color:rgb(153, 76, 195)">div</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, with the SSR function running on the server, the HTML source in the browser is as follows.</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">Output</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&lt;</span><span class="token tag" style="color:rgb(153, 76, 195)">div</span><span class="token tag" style="color:rgb(153, 76, 195)"> </span><span class="token tag attr-name" style="color:rgb(72, 118, 214);font-style:italic">id</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(153, 76, 195)">=</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag attr-value" style="color:rgb(153, 76, 195)">root</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&lt;</span><span class="token tag" style="color:rgb(153, 76, 195)">div</span><span class="token tag" style="color:rgb(153, 76, 195)"> </span><span class="token tag attr-name" style="color:rgb(72, 118, 214);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(153, 76, 195)">=</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag attr-value" style="color:rgb(153, 76, 195)">App</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag" style="color:rgb(153, 76, 195)"> </span><span class="token tag attr-name" style="color:rgb(72, 118, 214);font-style:italic">data-reactroot</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(153, 76, 195)">=</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain">...</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&lt;/</span><span class="token tag" style="color:rgb(153, 76, 195)">div</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&lt;/</span><span class="token tag" style="color:rgb(153, 76, 195)">div</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-alternative----build-and-deploy-with-rollupjs">Step 4 (alternative) -- build and deploy with rollup.js<a href="#step-4-alternative----build-and-deploy-with-rollupjs" class="hash-link" aria-label="Step 4 (alternative) -- build and deploy with rollup.js的直接链接" title="Step 4 (alternative) -- build and deploy with rollup.js的直接链接">​</a></h3><p>Alternatively, you could use the <a href="https://rollupjs.org/guide/en/" target="_blank" rel="noopener noreferrer">rollup.js</a> tool to <a href="/docs/zh/develop/javascript/npm">package all application components and library modules</a> into a single file for WasmEdge to execute.</p><p>Create a rollup config for the server that uses Babel Loader to transpile the code. Create the <code>rollup.config.js</code> file in the project&#x27;s root directory.</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> babel </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">require</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@rollup/plugin-babel&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> nodeResolve </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">require</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@rollup/plugin-node-resolve&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> commonjs </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">require</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@rollup/plugin-commonjs&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> replace </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">require</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@rollup/plugin-replace&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> globals </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">require</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;rollup-plugin-node-globals&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> builtins </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">require</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;rollup-plugin-node-builtins&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> plugin_async </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">require</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;rollup-plugin-async&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> css </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">require</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;rollup-plugin-import-css&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> svg </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">require</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;rollup-plugin-svg&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> babelOptions </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">babelrc</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">false</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">presets</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@babel/preset-react&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">babelHelpers</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;bundled&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">exports </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">input</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;./server/index.js&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">output</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">file</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;server-build/index.js&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">format</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;esm&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">external</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;std&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;wasi_net&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;wasi_http&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">plugins</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">plugin_async</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">babel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">babelOptions</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">nodeResolve</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">preferBuiltins</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">commonjs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">ignoreDynamicRequires</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">false</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">css</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">svg</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">base64</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">globals</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">builtins</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">replace</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">preventAssignment</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token string-property property" style="color:rgb(12, 150, 155)">&#x27;process.env.NODE_ENV&#x27;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(72, 118, 214)">JSON</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">stringify</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;production&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token string-property property" style="color:rgb(12, 150, 155)">&#x27;process.env.NODE_DEBUG&#x27;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(72, 118, 214)">JSON</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">stringify</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With this configuration, the transpiled server bundle will be output to the <code>server-build</code> folder in a file called <code>index.js</code>.</p><p>Next, add the dependent packages to the <code>package.json</code> then install with <code>npm</code>.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;devDependencies&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;@rollup/plugin-babel&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;^5.3.0&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;@rollup/plugin-commonjs&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;^21.0.1&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;@rollup/plugin-node-resolve&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;^7.1.3&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;@rollup/plugin-replace&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;^3.0.0&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;rollup&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;^2.60.1&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;rollup-plugin-async&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;^1.2.0&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;rollup-plugin-import-css&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;^3.0.3&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;rollup-plugin-node-builtins&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;^2.1.2&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;rollup-plugin-node-globals&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;^1.4.0&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;rollup-plugin-svg&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;^2.0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">install</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This completes the dependency installation and rollup configuration.</p><p>Now, revisit <code>package.json</code> and add helper npm scripts. Add <code>dev:build-server</code>, <code>dev:start-server</code> scripts to the <code>package.json</code> file to build and serve the SSR application.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token property" style="color:rgb(12, 150, 155)">&quot;scripts&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;dev:build-server&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;rollup -c rollup.config.js&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;dev:start-server&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;wasmedge --dir .:. wasmedge_quickjs.wasm ./server-build/index.js&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>The <code>dev:build-server</code> script sets the environment to <code>&quot;development&quot;</code> and invokes webpack with the configuration file you created earlier.</li><li>The <code>dev:start-server</code> script runs the WasmEdge server from the <code>wasmedge</code> CLI tool to serve the built output. The <code>wasmedge_quickjs.wasm</code> program contains the QuickJS runtime. <a href="/docs/zh/develop/javascript/hello_world">Learn more</a></li></ul><p>Now you can run the following commands to build the client-side app, bundle and transpile the server code, and start the server on <code>:8002</code>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">npm</span><span class="token plain"> run build</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">npm</span><span class="token plain"> run dev:build-server</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">npm</span><span class="token plain"> run dev:start-server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Open <code>http://localhost:8002/</code> in your web browser and observe your server-side rendered app.</p><p>Previously, the HTML source in the browser was simply the template with SSR placeholders.</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">Output</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&lt;</span><span class="token tag" style="color:rgb(153, 76, 195)">div</span><span class="token tag" style="color:rgb(153, 76, 195)"> </span><span class="token tag attr-name" style="color:rgb(72, 118, 214);font-style:italic">id</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(153, 76, 195)">=</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag attr-value" style="color:rgb(153, 76, 195)">root</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&lt;/</span><span class="token tag" style="color:rgb(153, 76, 195)">div</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, with the SSR function running on the server, the HTML source in the browser is as follows.</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">Output</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&lt;</span><span class="token tag" style="color:rgb(153, 76, 195)">div</span><span class="token tag" style="color:rgb(153, 76, 195)"> </span><span class="token tag attr-name" style="color:rgb(72, 118, 214);font-style:italic">id</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(153, 76, 195)">=</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag attr-value" style="color:rgb(153, 76, 195)">root</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&lt;</span><span class="token tag" style="color:rgb(153, 76, 195)">div</span><span class="token tag" style="color:rgb(153, 76, 195)"> </span><span class="token tag attr-name" style="color:rgb(72, 118, 214);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(153, 76, 195)">=</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag attr-value" style="color:rgb(153, 76, 195)">App</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag" style="color:rgb(153, 76, 195)"> </span><span class="token tag attr-name" style="color:rgb(72, 118, 214);font-style:italic">data-reactroot</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(153, 76, 195)">=</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag attr-value punctuation" style="color:rgb(153, 76, 195)">&quot;</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain">...</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&lt;/</span><span class="token tag" style="color:rgb(153, 76, 195)">div</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&lt;/</span><span class="token tag" style="color:rgb(153, 76, 195)">div</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wasmedge/docs/blob/main/docs/develop/javascript/ssr.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/zh/develop/javascript/rust"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Native JS API in Rust</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/zh/category/develop-wasm-apps-in-cc"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Develop WASM Apps in C/C++</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#getting-started" class="table-of-contents__link toc-highlight">Getting started</a></li><li><a href="#a-full-react-18-app" class="table-of-contents__link toc-highlight">A full React 18 app</a></li><li><a href="#appendix-the-create-react-app-template" class="table-of-contents__link toc-highlight">Appendix the create-react-app template</a><ul><li><a href="#step-1--create-the-react-app" class="table-of-contents__link toc-highlight">Step 1 — Create the React App</a></li><li><a href="#step-2--create-an-wasmedge-quickjs-server-and-render-the-app-component" class="table-of-contents__link toc-highlight">Step 2 — Create an WasmEdge QuickJS Server and Render the App Component</a></li><li><a href="#step-3--build-and-deploy" class="table-of-contents__link toc-highlight">Step 3 — Build and deploy</a></li><li><a href="#step-4-alternative----build-and-deploy-with-rollupjs" class="table-of-contents__link toc-highlight">Step 4 (alternative) -- build and deploy with rollup.js</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/zh/start/overview">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/zh/develop/overview">Develop</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/zh/embed/overview">Embeds</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/zh/contribute/overview">Contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/WasmEdge/WasmEdge" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.secondstate.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Second State<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.secondstate.io/articles/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Articles &amp; Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/zh/talks">WasmEdge Talks</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/zh/releases">Releases</a></li><li class="footer__item"><a href="https://wasmedge.org/docs/sitemap.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sitemap<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://groups.google.com/g/wasmedge/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mailing List<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/U4B5sFTkFc" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/realwasmedge" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://cloud-native.slack.com/archives/C0215BBK248" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack #WasmEdge<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docs.google.com/document/d/1iFlVl7R97Lze4RDykzElJGDjjWYDlkI8Rhf8g4dQ5Rk/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community Meeting<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://wasmedge.org/" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/docs/zh/img/wasmedge_logo.svg" alt="WasmEdge logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/docs/zh/img/wasmedge_logo.svg" alt="WasmEdge logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Copyright © 2023 WasmEdge. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docs/zh/assets/js/runtime~main.44970857.js"></script>
<script src="/docs/zh/assets/js/main.023f9050.js"></script>
</body>
</html>