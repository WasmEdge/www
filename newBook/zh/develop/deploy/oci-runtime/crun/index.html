<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-develop/deploy/oci-runtime/crun">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">8.5.2 Deploy with crun | WasmEdge Book</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://alabulei1.github.io/book/zh/develop/deploy/oci-runtime/crun"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="8.5.2 Deploy with crun | WasmEdge Book"><meta data-rh="true" name="description" content="The crun project has WasmEdge support baked in. This chapter will walk you through deploying Wasm images with crun."><meta data-rh="true" property="og:description" content="The crun project has WasmEdge support baked in. This chapter will walk you through deploying Wasm images with crun."><link data-rh="true" rel="icon" href="/book/zh/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://alabulei1.github.io/book/zh/develop/deploy/oci-runtime/crun"><link data-rh="true" rel="alternate" href="https://alabulei1.github.io/book/develop/deploy/oci-runtime/crun" hreflang="en"><link data-rh="true" rel="alternate" href="https://alabulei1.github.io/book/zh/develop/deploy/oci-runtime/crun" hreflang="zh"><link data-rh="true" rel="alternate" href="https://alabulei1.github.io/book/zh-TW/develop/deploy/oci-runtime/crun" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://alabulei1.github.io/book/develop/deploy/oci-runtime/crun" hreflang="x-default"><link rel="stylesheet" href="/book/zh/assets/css/styles.bf154a13.css">
<link rel="preload" href="/book/zh/assets/js/runtime~main.4d3735d7.js" as="script">
<link rel="preload" href="/book/zh/assets/js/main.ca6d7535.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/book/zh/"><div class="navbar__logo"><img src="/book/zh/img/logo.svg" alt="WasmEdge Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/book/zh/img/logo.svg" alt="WasmEdge Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">WasmEdge</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/book/zh/develop/overview">Develop</a><a class="navbar__item navbar__link" href="/book/zh/embed/overview">Embed</a><a class="navbar__item navbar__link" href="/book/zh/contribute/overview">Extend</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link icon-link language navbar__item"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/book/develop/deploy/oci-runtime/crun" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/book/zh/develop/deploy/oci-runtime/crun" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">简体中文</a></li><li><a href="/book/zh-TW/develop/deploy/oci-runtime/crun" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-TW">繁體中文</a></li><li><a href="https://translate.google.com/" target="_blank" class="dropdown__link">Translate<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/WasmEdge/WasmEdge" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/book/zh/develop/overview">Develop Wasm Apps</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/book/zh/category/getting-started-with-wasmedge">Getting Started with WasmEdge</a><button aria-label="打开/收起侧边栏菜单「Getting Started with WasmEdge」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/book/zh/category/what-is-wasmedge">What is WasmEdge</a><button aria-label="打开/收起侧边栏菜单「What is WasmEdge」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/book/zh/category/building-and-running-wasmedge-apps">Building and running WasmEdge apps</a><button aria-label="打开/收起侧边栏菜单「Building and running WasmEdge apps」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/book/zh/category/develop-wasm-apps-in-rust">Develop Wasm Apps in Rust</a><button aria-label="打开/收起侧边栏菜单「Develop Wasm Apps in Rust」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/book/zh/category/develop-wasm-apps-in-javascript">Develop Wasm Apps in JavaScript</a><button aria-label="打开/收起侧边栏菜单「Develop Wasm Apps in JavaScript」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/book/zh/category/develop-wasm-apps-in-cc">Develop Wasm Apps in C/C++</a><button aria-label="打开/收起侧边栏菜单「Develop Wasm Apps in C/C++」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/book/zh/category/develop-wasm-apps-in-go">Develop Wasm Apps in Go</a><button aria-label="打开/收起侧边栏菜单「Develop Wasm Apps in Go」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/book/zh/category/deploy-wasmedge-apps-in-kubernetes">Deploy WasmEdge apps in Kubernetes</a><button aria-label="打开/收起侧边栏菜单「Deploy WasmEdge apps in Kubernetes」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/book/zh/develop/deploy/intro">8.1 Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/book/zh/develop/deploy/docker">8.2 Docker + Wasm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/book/zh/develop/deploy/podman">8.3 Podman</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/book/zh/develop/deploy/kubernetes">8.4 Kubernetes</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/book/zh/category/low-level-runtime-support">Low level runtime support</a><button aria-label="打开/收起侧边栏菜单「Low level runtime support」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/book/zh/develop/deploy/oci-runtime/containerd">8.5.1 Deploy with containerd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/book/zh/develop/deploy/oci-runtime/crun">8.5.2 Deploy with crun</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/book/zh/develop/deploy/oci-runtime/youki">8.5.3 Deploy with youki</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/book/zh/develop/deploy/oci-runtime/quark">8.5.4 Deploy with quark</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/book/zh/category/use-cases">Use Cases</a><button aria-label="打开/收起侧边栏菜单「Use Cases」" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/book/zh/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/book/zh/category/deploy-wasmedge-apps-in-kubernetes"><span itemprop="name">Deploy WasmEdge apps in Kubernetes</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/book/zh/category/low-level-runtime-support"><span itemprop="name">Low level runtime support</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">8.5.2 Deploy with crun</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>8.5.2 Deploy with crun</h1><p>The <a href="https://github.com/containers/crun" target="_blank" rel="noopener noreferrer">crun project</a> has WasmEdge support baked in. This chapter will walk you through deploying Wasm images with crun.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="fedora-platform">Fedora Platform<a class="hash-link" href="#fedora-platform" title="标题的直接链接">​</a></h2><p>The crun fedora package has WasmEdge as the default WebAssembly Runtime. So the easiest way to deploy WasmEdge with crun in on the Fedora Linux distributions. For the other Linux distributions, please refer to the <a href="#other-linux-platforms">next section</a>.</p><p>First, install crun and WasmEdge on your fedora machine.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo dnf -y install wasmedge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo dnf -y install crun</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, run <code>crun -v</code> to check if you installed successfully.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">crun -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crun version 1.7.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">commit: 0356bf4aff9a133d655dc13b1d9ac9424706cac4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rundir: /run/user/501/crun</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec: 1.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+SYSTEMD +SELINUX +APPARMOR +CAP +SECCOMP +EBPF +CRIU +LIBKRUN +WASM:wasmedge +YAJL</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can see that crun has WasmEdge package already.</p><p>Next, you can run Wasm apps on your fedora machine.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="other-linux-platforms">Other Linux Platforms<a class="hash-link" href="#other-linux-platforms" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="quick-start">Quick start<a class="hash-link" href="#quick-start" title="标题的直接链接">​</a></h3><p>The <a href="https://github.com/second-state/wasmedge-containers-examples/" target="_blank" rel="noopener noreferrer">GitHub repo</a> contains scripts and Github Actions for running our example apps on CRI-O.</p><ul><li>Simple WebAssembly example <a href="https://github.com/second-state/wasmedge-containers-examples/blob/main/crio/README.md" target="_blank" rel="noopener noreferrer">Quick start</a> | <a href="https://github.com/second-state/wasmedge-containers-examples/blob/main/.github/workflows/crio.yml" target="_blank" rel="noopener noreferrer">Github Actions</a></li><li>HTTP service example <a href="https://github.com/second-state/wasmedge-containers-examples/blob/main/crio/http_server/README.md" target="_blank" rel="noopener noreferrer">Quick start</a> | <a href="https://github.com/second-state/wasmedge-containers-examples/blob/main/.github/workflows/crio-server.yml" target="_blank" rel="noopener noreferrer">Github Actions</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="标题的直接链接">​</a></h3><ol><li><a href="/book/zh/develop/build-and-run/install">Install WasmEdge</a></li><li>Build and configure crun with WasmEdge support</li></ol><p>For now, the easiest approach is just built it yourself from source. First, let&#x27;s make sure that <code>crun</code> dependencies are installed on your Ubuntu 20.04.
For other Linux distributions, please <a href="https://github.com/containers/crun#readme" target="_blank" rel="noopener noreferrer">see here</a>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> -y </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> gcc build-essential pkgconf libtool </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libsystemd-dev libprotobuf-c-dev libcap-dev libseccomp-dev libyajl-dev </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    go-md2man libtool autoconf python3 automake</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, configure, build, and install a <code>crun</code> binary with WasmEdge support.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/containers/crun</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> crun</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./autogen.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./configure --with-wasmedge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Install and configure CRI-O </li></ol><p>Use the following commands to install CRI-O on your system.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">OS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;xUbuntu_20.04&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">VERSION</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;1.21&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> -y libseccomp2 </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> update -y libseccomp2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;deb https://download.opensuse.org/repositories/devel:/kubic:/libcontainers:/stable/</span><span class="token string variable" style="color:#36acaa">$OS</span><span class="token string" style="color:#e3116c">/ /&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /etc/apt/sources.list.d/devel:kubic:libcontainers:stable.list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;deb https://download.opensuse.org/repositories/devel:/kubic:/libcontainers:/stable:/cri-o:/</span><span class="token string variable" style="color:#36acaa">$VERSION</span><span class="token string" style="color:#e3116c">/</span><span class="token string variable" style="color:#36acaa">$OS</span><span class="token string" style="color:#e3116c">/ /&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /etc/apt/sources.list.d/devel:kubic:libcontainers:stable:cri-o:</span><span class="token variable" style="color:#36acaa">$VERSION</span><span class="token plain">.list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -L https://download.opensuse.org/repositories/devel:kubic:libcontainers:stable:cri-o:</span><span class="token variable" style="color:#36acaa">$VERSION</span><span class="token plain">/</span><span class="token variable" style="color:#36acaa">$OS</span><span class="token plain">/Release.key </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> apt-key </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -L https://download.opensuse.org/repositories/devel:/kubic:/libcontainers:/stable/</span><span class="token variable" style="color:#36acaa">$OS</span><span class="token plain">/Release.key </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> apt-key </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> criu libyajl2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> cri-o cri-o-runc cri-tools containernetworking-plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start crio</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-cri-o-to-use-crun">Configure CRI-O to use crun<a class="hash-link" href="#configure-cri-o-to-use-crun" title="标题的直接链接">​</a></h3><p>CRI-O uses the <code>runc</code> runtime by default and we need to configure it to use <code>crun</code> instead.
That is done by adding to two configuration files.</p><p>First, create a <code>/etc/crio/crio.conf</code> file and add the following lines as its content. It tells CRI-O to use <code>crun</code> by default.</p><div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[crio.runtime]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_runtime = &quot;crun&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>crun</code> runtime is in turn defined in the <code>/etc/crio/crio.conf.d/01-crio-runc.conf</code> file.</p><div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[crio.runtime.runtimes.runc]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">runtime_path = &quot;/usr/lib/cri-o-runc/sbin/runc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">runtime_type = &quot;oci&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">runtime_root = &quot;/run/runc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The above is the original content</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Add crun here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[crio.runtime.runtimes.crun]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">runtime_path = &quot;/usr/bin/crun&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">runtime_type = &quot;oci&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">runtime_root = &quot;/run/crun&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, restart CRI-O to apply the configuration changes.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart crio</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-a-simple-webassembly-app">Run a simple WebAssembly app<a class="hash-link" href="#run-a-simple-webassembly-app" title="标题的直接链接">​</a></h3><p>Now, we can run a simple WebAssembly program using CRI-O. <a href="https://github.com/second-state/wasmedge-containers-examples/blob/main/simple_wasi_app.md" target="_blank" rel="noopener noreferrer">A separate article</a> explains how to compile, package, and publish the WebAssembly program as a container image to Docker hub.</p><p>In this section, we will start off pulling this WebAssembly-based container image from Docker hub using CRI-O tools.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> crictl pull docker.io/hydai/wasm-wasi-example:with-wasm-annotation</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, we need to create two simple configuration files that specifies how CRI-O should run this WebAssembly image in a sandbox. We already have those two files <a href="https://github.com/second-state/wasmedge-containers-examples/blob/main/crio/container_wasi.json" target="_blank" rel="noopener noreferrer">container_wasi.json</a> and <a href="https://github.com/second-state/wasmedge-containers-examples/blob/main/crio/sandbox_config.json" target="_blank" rel="noopener noreferrer">sandbox_config.json</a>. You can just download them to your local directory as follows.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://raw.githubusercontent.com/second-state/wasmedge-containers-examples/main/crio/sandbox_config.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://raw.githubusercontent.com/second-state/wasmedge-containers-examples/main/crio/container_wasi.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now you can use CRI-O to create a pod and a container using the specified configurations.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Create the POD. Output will be different from example.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> crictl runp sandbox_config.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7992e75df00cc1cf4bff8bff660718139e3ad973c7180baceb9c84d074b516a4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Set a helper variable for later use.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token assign-left variable" style="color:#36acaa">POD_ID</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">7992e75df00cc1cf4bff8bff660718139e3ad973c7180baceb9c84d074b516a4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create the container instance. Output will be different from example.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> crictl create </span><span class="token variable" style="color:#36acaa">$POD_ID</span><span class="token plain"> container_wasi.json sandbox_config.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Set a helper variable for later use.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">CONTAINER_ID</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">1d056e4a8a168f0c76af122d42c98510670255b16242e81f8e8bce8bd3a4476f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Starting the container would execute the WebAssembly program. You can see the output in the console.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># List the container, the state should be `Created`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> crictl </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER           IMAGE                                          CREATED              STATE               NAME                     ATTEMPT             POD ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1d056e4a8a168       wasmedge/example-wasi:latest                   About a minute ago   Created             podsandbox1-wasm-wasi   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">                   7992e75df00cc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Start the container</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> crictl start </span><span class="token variable" style="color:#36acaa">$CONTAINER_ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check the container status again.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># If the container is not finishing its job, you will see the Running state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Because this example is very tiny. You may see Exited at this moment.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> crictl </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER           IMAGE                                          CREATED              STATE               NAME                     ATTEMPT             POD ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1d056e4a8a168       wasmedge/example-wasi:latest                   About a minute ago   Running             podsandbox1-wasm-wasi   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">                   7992e75df00cc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># When the container is finished. You can see the state becomes Exited.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> crictl </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER           IMAGE                                          CREATED              STATE               NAME                     ATTEMPT             POD ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1d056e4a8a168       wasmedge/example-wasi:latest                   About a minute ago   Exited              podsandbox1-wasm-wasi   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">                   7992e75df00cc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check the container&#x27;s logs. It should show outputs from the WebAssembly programs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> crictl logs </span><span class="token variable" style="color:#36acaa">$CONTAINER_ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">: Print Random Number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Random number: </span><span class="token number" style="color:#36acaa">960251471</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">: Print Random Bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Random bytes: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">50</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">222</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">62</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">128</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">120</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">26</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">64</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">42</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">210</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">137</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">176</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">90</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">60</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">24</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">183</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">56</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">150</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">35</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">209</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">211</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">141</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">146</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">61</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">215</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">167</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">194</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">15</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">44</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">156</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">27</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">179</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">23</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">241</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">138</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">71</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">32</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">173</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">159</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">180</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">21</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">198</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">197</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">247</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">35</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">75</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">245</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">31</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">246</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">23</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">54</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">192</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">103</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">72</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">186</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">39</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">182</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">248</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">146</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">70</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">244</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">28</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">166</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">197</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">42</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">109</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">245</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">83</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">35</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">106</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">130</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">233</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">143</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">90</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">78</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">155</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">29</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">230</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">34</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">58</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">49</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">234</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">230</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">145</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">119</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">83</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">44</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">111</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">57</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">164</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">82</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">120</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">183</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">194</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">201</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">133</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">106</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">73</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">164</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">155</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">224</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">218</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">73</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">31</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">54</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">28</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">124</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">38</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">253</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">114</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">222</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">217</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">202</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">59</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">138</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">155</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">71</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">178</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">113</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">: Call an </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Printed from wasi: This is from a main </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This is from a main </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">: Print Environment Variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The </span><span class="token function" style="color:#d73a49">env</span><span class="token plain"> vars are as follows.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token environment constant" style="color:#36acaa">PATH</span><span class="token builtin class-name">:</span><span class="token plain"> /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token environment constant" style="color:#36acaa">TERM</span><span class="token builtin class-name">:</span><span class="token plain"> xterm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token environment constant" style="color:#36acaa">HOSTNAME</span><span class="token builtin class-name">:</span><span class="token plain"> crictl_host</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token environment constant" style="color:#36acaa">PATH</span><span class="token builtin class-name">:</span><span class="token plain"> /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The args are as follows.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/containers/storage/overlay/006e7cf16e82dc7052994232c436991f429109edea14a8437e74f601b5ee1e83/merged/wasi_example_main.wasm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">50000000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">: Create a </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">/tmp.txt</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"> with content </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">This is </span><span class="token variable keyword" style="color:#00009f">in</span><span class="token variable" style="color:#36acaa"> a </span><span class="token variable function" style="color:#d73a49">file</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">: Read the content from the previous </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">File content is This is </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> a </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">: Delete the previous </span><span class="token function" style="color:#d73a49">file</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, you can try to run the app in <a href="/book/zh/develop/deploy/kubernetes">Kubernetes</a>!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-a-http-server-app">Run a HTTP server app<a class="hash-link" href="#run-a-http-server-app" title="标题的直接链接">​</a></h3><p>Finally, we can run a simple WebAssembly-based HTTP micro-service in CRI-O.
<a href="https://github.com/second-state/wasmedge-containers-examples/blob/main/http_server_wasi_app.md" target="_blank" rel="noopener noreferrer">A separate article</a> explains how to compile, package, and publish the WebAssembly program as a container image to Docker hub.
In this section, we will start off pulling this WebAssembly-based container image from Docker hub using CRI-O tools.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> crictl pull docker.io/avengermojo/http_server:with-wasm-annotation</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, we need to create two simple configuration files that specifies how CRI-O should run this WebAssembly image in a sandbox. We already have those two files <a href="https://raw.githubusercontent.com/second-state/wasmedge-containers-examples/main/crio/http_server/container_http_server.json" target="_blank" rel="noopener noreferrer">container_http_server.json</a> and <a href="https://github.com/second-state/wasmedge-containers-examples/blob/main/crio/sandbox_config.json" target="_blank" rel="noopener noreferrer">sandbox_config.json</a>.
You can just download them to your local directory as follows.</p><blockquote><p>The <code>sandbox_config.json</code> file is the same for the simple WASI example and the HTTP server example. The other <code>container_*.json</code> file is application specific as it contains the application&#x27;s Docker Hub URL.</p></blockquote><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://raw.githubusercontent.com/second-state/wasmedge-containers-examples/main/crio/sandbox_config.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://raw.githubusercontent.com/second-state/wasmedge-containers-examples/main/crio/http_server/container_http_server.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now you can use CRI-O to create a pod and a container using the specified configurations.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Create the POD. Output will be different from example.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> crictl runp sandbox_config.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7992e75df00cc1cf4bff8bff660718139e3ad973c7180baceb9c84d074b516a4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Set a helper variable for later use.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token assign-left variable" style="color:#36acaa">POD_ID</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">7992e75df00cc1cf4bff8bff660718139e3ad973c7180baceb9c84d074b516a4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create the container instance. Output will be different from example.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> crictl create </span><span class="token variable" style="color:#36acaa">$POD_ID</span><span class="token plain"> container_http_server.json sandbox_config.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Set a helper variable for later use.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">CONTAINER_ID</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">1d056e4a8a168f0c76af122d42c98510670255b16242e81f8e8bce8bd3a4476f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Starting the container would execute the WebAssembly program. You can see the output in the console.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Start the container</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> crictl start </span><span class="token variable" style="color:#36acaa">$CONTAINER_ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check the container status. It should be Running. </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># If not, wait a few seconds and check again</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> crictl </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER           IMAGE                                          CREATED                  STATE               NAME                ATTEMPT             POD ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4eeddf8613691       wasmedge/example-wasi-http:latest              Less than a second ago   Running             http_server         </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">                   1d84f30e7012e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check the container&#x27;s logs to see the HTTP server is listening at port 1234</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> crictl logs </span><span class="token variable" style="color:#36acaa">$CONTAINER_ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">new connection at </span><span class="token number" style="color:#36acaa">1234</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Get the IP address assigned to the container</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> crictl inspect </span><span class="token variable" style="color:#36acaa">$CONTAINER_ID</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> IP.0 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cut</span><span class="token plain"> -d: -f </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cut</span><span class="token plain"> -d</span><span class="token string" style="color:#e3116c">&#x27;&quot;&#x27;</span><span class="token plain"> -f </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">10.85</span><span class="token plain">.0.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Test the HTTP service at that IP address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -d </span><span class="token string" style="color:#e3116c">&quot;name=WasmEdge&quot;</span><span class="token plain"> -X POST http://10.85.0.2:1234</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo: </span><span class="token assign-left variable" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">WasmEdge</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, you can try to run it in <a href="/book/zh/develop/deploy/kubernetes">Kubernetes</a>!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/alabulei1/book/docs/develop/deploy/oci-runtime/crun.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/book/zh/develop/deploy/oci-runtime/containerd"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">8.5.1 Deploy with containerd</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/book/zh/develop/deploy/oci-runtime/youki"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">8.5.3 Deploy with youki</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#fedora-platform" class="table-of-contents__link toc-highlight">Fedora Platform</a></li><li><a href="#other-linux-platforms" class="table-of-contents__link toc-highlight">Other Linux Platforms</a><ul><li><a href="#quick-start" class="table-of-contents__link toc-highlight">Quick start</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#configure-cri-o-to-use-crun" class="table-of-contents__link toc-highlight">Configure CRI-O to use crun</a></li><li><a href="#run-a-simple-webassembly-app" class="table-of-contents__link toc-highlight">Run a simple WebAssembly app</a></li><li><a href="#run-a-http-server-app" class="table-of-contents__link toc-highlight">Run a HTTP server app</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/book/zh/develop/overview">Develop</a></li><li class="footer__item"><a class="footer__link-item" href="/book/zh/embed/overview">Embed</a></li><li class="footer__item"><a class="footer__link-item" href="/book/zh/contribute/overview">Contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/U4B5sFTkFc" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/realwasmedge" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 WasmEdge. Built with Docusaurus.</div></div></div></footer></div>
<script src="/book/zh/assets/js/runtime~main.4d3735d7.js"></script>
<script src="/book/zh/assets/js/main.ca6d7535.js"></script>
</body>
</html>