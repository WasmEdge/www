<!doctype html>
<html lang="zh-TW" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-develop/rust/socket_networking/client">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">4.4.1 Client | WasmEdge Book</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://alabulei1.github.io/book/zh-TW/develop/rust/socket_networking/client"><meta data-rh="true" name="docusaurus_locale" content="zh-TW"><meta data-rh="true" name="docsearch:language" content="zh-TW"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="4.4.1 Client | WasmEdge Book"><meta data-rh="true" name="description" content="The wasmedgewasisocket crate enables Rust developers to create networking applications and compile them into WebAssembly for WasmEdge Runtime. One of the key features of WasmEdge is that it supports non-blocking sockets. That allows even a single threaded WASM application to handle concurrent network requests. For example, while the program is waiting for data to stream in from one connection, it can start or handle another connection."><meta data-rh="true" property="og:description" content="The wasmedgewasisocket crate enables Rust developers to create networking applications and compile them into WebAssembly for WasmEdge Runtime. One of the key features of WasmEdge is that it supports non-blocking sockets. That allows even a single threaded WASM application to handle concurrent network requests. For example, while the program is waiting for data to stream in from one connection, it can start or handle another connection."><link data-rh="true" rel="icon" href="/book/zh-TW/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://alabulei1.github.io/book/zh-TW/develop/rust/socket_networking/client"><link data-rh="true" rel="alternate" href="https://alabulei1.github.io/book/develop/rust/socket_networking/client" hreflang="en"><link data-rh="true" rel="alternate" href="https://alabulei1.github.io/book/zh/develop/rust/socket_networking/client" hreflang="zh"><link data-rh="true" rel="alternate" href="https://alabulei1.github.io/book/zh-TW/develop/rust/socket_networking/client" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://alabulei1.github.io/book/develop/rust/socket_networking/client" hreflang="x-default"><link rel="stylesheet" href="/book/zh-TW/assets/css/styles.bf154a13.css">
<link rel="preload" href="/book/zh-TW/assets/js/runtime~main.92445789.js" as="script">
<link rel="preload" href="/book/zh-TW/assets/js/main.a4578077.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳至主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳至主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/book/zh-TW/"><div class="navbar__logo"><img src="/book/zh-TW/img/logo.svg" alt="WasmEdge Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/book/zh-TW/img/logo.svg" alt="WasmEdge Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">WasmEdge</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/book/zh-TW/develop/overview">Develop</a><a class="navbar__item navbar__link" href="/book/zh-TW/embed/overview">Embed</a><a class="navbar__item navbar__link" href="/book/zh-TW/contribute/overview">Extend</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link icon-link language navbar__item"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>繁體中文</a><ul class="dropdown__menu"><li><a href="/book/develop/rust/socket_networking/client" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/book/zh/develop/rust/socket_networking/client" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">简体中文</a></li><li><a href="/book/zh-TW/develop/rust/socket_networking/client" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-TW">繁體中文</a></li><li><a href="https://translate.google.com/" target="_blank" class="dropdown__link">Translate<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/WasmEdge/WasmEdge" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切換淺色/暗黑模式（當前為淺色模式）" aria-label="切換淺色/暗黑模式（當前為淺色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到頂部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/book/zh-TW/develop/overview">Develop Wasm Apps</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/book/zh-TW/category/getting-started-with-wasmedge">Getting Started with WasmEdge</a><button aria-label="打開/收起側邊欄選單「Getting Started with WasmEdge」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/book/zh-TW/category/what-is-wasmedge">What is WasmEdge</a><button aria-label="打開/收起側邊欄選單「What is WasmEdge」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/book/zh-TW/category/building-and-running-wasmedge-apps">Building and running WasmEdge apps</a><button aria-label="打開/收起側邊欄選單「Building and running WasmEdge apps」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/book/zh-TW/category/develop-wasm-apps-in-rust">Develop Wasm Apps in Rust</a><button aria-label="打開/收起側邊欄選單「Develop Wasm Apps in Rust」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/book/zh-TW/develop/rust/setup">4.0 Set up Software for Building and Compiling Rust Programs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/book/zh-TW/develop/rust/hello_world">4.1 Hello world</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/book/zh-TW/develop/rust/os">4.2 Access OS services</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/book/zh-TW/category/43-http-services">4.3 HTTP services</a><button aria-label="打開/收起側邊欄選單「4.3 HTTP services」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/book/zh-TW/category/44-socket-networking">4.4 Socket networking</a><button aria-label="打開/收起側邊欄選單「4.4 Socket networking」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/book/zh-TW/develop/rust/socket_networking/client">4.4.1 Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/book/zh-TW/develop/rust/socket_networking/server">4.4.1 Server</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/book/zh-TW/category/45-ai-inference">4.5 AI Inference</a><button aria-label="打開/收起側邊欄選單「4.5 AI Inference」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/book/zh-TW/develop/rust/my_sql_driver">4.6 MySQL-based Database Driver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/book/zh-TW/develop/rust/dapr">4.7 Use WasmEdge&#x27;s Dapr SDK to Connect Dapr Sidecar</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/book/zh-TW/category/develop-wasm-apps-in-javascript">Develop Wasm Apps in JavaScript</a><button aria-label="打開/收起側邊欄選單「Develop Wasm Apps in JavaScript」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/book/zh-TW/category/develop-wasm-apps-in-cc">Develop Wasm Apps in C/C++</a><button aria-label="打開/收起側邊欄選單「Develop Wasm Apps in C/C++」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/book/zh-TW/category/develop-wasm-apps-in-go">Develop Wasm Apps in Go</a><button aria-label="打開/收起側邊欄選單「Develop Wasm Apps in Go」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/book/zh-TW/category/deploy-wasmedge-apps-in-kubernetes">Deploy WasmEdge apps in Kubernetes</a><button aria-label="打開/收起側邊欄選單「Deploy WasmEdge apps in Kubernetes」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="頁面路徑"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主頁面" class="breadcrumbs__link" href="/book/zh-TW/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/book/zh-TW/category/develop-wasm-apps-in-rust"><span itemprop="name">Develop Wasm Apps in Rust</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/book/zh-TW/category/44-socket-networking"><span itemprop="name">4.4 Socket networking</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">4.4.1 Client</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本頁導覽</button></div><div class="theme-doc-markdown markdown"><h1>4.4.1 Client</h1><p>The <a href="https://github.com/second-state/wasmedge_wasi_socket" target="_blank" rel="noopener noreferrer">wasmedge_wasi_socket</a> crate enables Rust developers to create networking applications and compile them into WebAssembly for WasmEdge Runtime. One of the key features of WasmEdge is that it supports non-blocking sockets. That allows even a single threaded WASM application to handle concurrent network requests. For example, while the program is waiting for data to stream in from one connection, it can start or handle another connection.</p><p>While the simple HTTP connections from the previous chapter are easy to implement, they are not ready for production use. If the program can only have one connection open at a time (e.g., blocking), the fast CPU would be waiting for the slow network. Non-blocking I/O means that the application program can keep multiple connections open at the same time, and process data in and out of those connections as they come in. The program can either alternatingly poll those open connections or wait for incoming data to trigger async functions. That allows I/O intensive programs to run much faster even in a single-threaded environment. </p><p>So in this chapter, we will start with <a href="#a-simple-http-client">a simple HTTP client</a> and <a href="#a-non-blocking-http-client-example">a non-blocking HTTP client application</a>.</p><blockquote><p>Before we started, make sure <a href="/book/zh-TW/develop/rust/setup">you have Rust and WasmEdge installed</a>.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-simple-http-client">A Simple HTTP Client<a class="hash-link" href="#a-simple-http-client" title="標題的直接連結">​</a></h2><p>The <a href="https://github.com/second-state/wasmedge_wasi_socket/tree/main/examples/http_client" target="_blank" rel="noopener noreferrer">source code</a> for the HTTP client is available as follows.</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use wasmedge_http_req::request;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let mut writer = Vec::new(); //container for body of a response</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let res = request::get(&quot;http://127.0.0.1:1234/get&quot;, &amp;mut writer).unwrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  println!(&quot;GET&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  println!(&quot;Status: {} {}&quot;, res.status_code(), res.reason());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  println!(&quot;Headers {}&quot;, res.headers());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  println!(&quot;{}&quot;, String::from_utf8_lossy(&amp;writer));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let mut writer = Vec::new(); //container for body of a response</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const BODY: &amp;[u8; 27] = b&quot;field1=value1&amp;field2=value2&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // let res = request::post(&quot;https://httpbin.org/post&quot;, BODY, &amp;mut writer).unwrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // no https , no dns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let res = request::post(&quot;http://127.0.0.1:1234/post&quot;, BODY, &amp;mut writer).unwrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  println!(&quot;POST&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  println!(&quot;Status: {} {}&quot;, res.status_code(), res.reason());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  println!(&quot;Headers {}&quot;, res.headers());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  println!(&quot;{}&quot;, String::from_utf8_lossy(&amp;writer));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can build and run <a href="https://github.com/second-state/wasmedge_wasi_socket/tree/main/examples/http_client" target="_blank" rel="noopener noreferrer">the example</a> in WasmEdge as follows.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># get the source code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git clone https://github.com/second-state/wasmedge_wasi_socket.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cd wasmedge_wasi_socket/http_client/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Build the Rust Code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cargo build --target wasm32-wasi --release</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Use the AoT compiler to get better performance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wasmedgec target/wasm32-wasi/release/http_client.wasm target/wasm32-wasi/release/http_client.wasm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Run the example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wasmedge target/wasm32-wasi/release/http_client.wasm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-non-blocking-http-client-example">A non-blocking HTTP client example<a class="hash-link" href="#a-non-blocking-http-client-example" title="標題的直接連結">​</a></h2><p>The <a href="https://github.com/second-state/wasmedge_wasi_socket/tree/main/examples/nonblock_http_client" target="_blank" rel="noopener noreferrer">source code</a> for a non-blocking HTTP client application is available. The following <code>main()</code> function starts two HTTP connections. The program keeps both connections open, and alternatingly checks for incoming data from them. In another word, the two connections are not blocking each other. Their data are handled concurrently (or alternatingly) as the data comes in.</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use httparse::{Response, EMPTY_HEADER};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::io::{self, Read, Write};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use std::str::from_utf8;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use wasmedge_wasi_socket::TcpStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fn main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let req = &quot;GET / HTTP/1.0\n\n&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut first_connection = TcpStream::connect(&quot;127.0.0.1:80&quot;).unwrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    first_connection.set_nonblocking(true).unwrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    first_connection.write_all(req.as_bytes()).unwrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut second_connection = TcpStream::connect(&quot;127.0.0.1:80&quot;).unwrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    second_connection.set_nonblocking(true).unwrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    second_connection.write_all(req.as_bytes()).unwrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut first_buf = vec![0; 4096];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut first_bytes_read = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut second_buf = vec![0; 4096];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut second_bytes_read = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    loop {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let mut first_complete = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let mut second_complete = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if !first_complete {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            match read_data(&amp;mut first_connection, &amp;mut first_buf, first_bytes_read) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Ok((bytes_read, false)) =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    first_bytes_read = bytes_read;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Ok((bytes_read, true)) =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    println!(&quot;First connection completed&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if bytes_read != 0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        parse_data(&amp;first_buf, bytes_read);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    first_complete = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Err(e) =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    println!(&quot;First connection error: {}&quot;, e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    first_complete = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if !second_complete {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            match read_data(&amp;mut second_connection, &amp;mut second_buf, second_bytes_read) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Ok((bytes_read, false)) =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    second_bytes_read = bytes_read;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Ok((bytes_read, true)) =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    println!(&quot;Second connection completed&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if bytes_read != 0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        parse_data(&amp;second_buf, bytes_read);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    second_complete = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Err(e) =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    println!(&quot;Second connection error: {}&quot;, e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    second_complete = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if first_complete &amp;&amp; second_complete {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can build and run <a href="https://github.com/second-state/wasmedge_wasi_socket/tree/main/examples/nonblock_http_client" target="_blank" rel="noopener noreferrer">the example</a> in WasmEdge as follows.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># get the source code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git clone https://github.com/second-state/wasmedge_wasi_socket.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cd wasmedge_wasi_socket/nonblock_http_client/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Build the Rust Code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cargo build --target wasm32-wasi --release</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Use the AoT compiler to get better performance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wasmedgec target/wasm32-wasi/release/nonblock_http_client.wasm target/wasm32-wasi/release/nonblock_http_client.wasm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Run the example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wasmedge target/wasm32-wasi/release/nonblock_http_client.wasm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/alabulei1/book/docs/develop/rust/socket_networking/client.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>編輯此頁</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件分頁導覽"><a class="pagination-nav__link pagination-nav__link--prev" href="/book/zh-TW/category/44-socket-networking"><div class="pagination-nav__sublabel">上一頁</div><div class="pagination-nav__label">4.4 Socket networking</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/book/zh-TW/develop/rust/socket_networking/server"><div class="pagination-nav__sublabel">下一頁</div><div class="pagination-nav__label">4.4.1 Server</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#a-simple-http-client" class="table-of-contents__link toc-highlight">A Simple HTTP Client</a></li><li><a href="#a-non-blocking-http-client-example" class="table-of-contents__link toc-highlight">A non-blocking HTTP client example</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/book/zh-TW/develop/overview">Develop</a></li><li class="footer__item"><a class="footer__link-item" href="/book/zh-TW/embed/overview">Embed</a></li><li class="footer__item"><a class="footer__link-item" href="/book/zh-TW/contribute/overview">Contribute</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/U4B5sFTkFc" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/realwasmedge" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 WasmEdge. Built with Docusaurus.</div></div></div></footer></div>
<script src="/book/zh-TW/assets/js/runtime~main.92445789.js"></script>
<script src="/book/zh-TW/assets/js/main.a4578077.js"></script>
</body>
</html>